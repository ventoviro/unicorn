!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.S3Uploader=e():t.S3Uploader=e()}(self,(()=>(()=>{"use strict";var t={d:(e,r)=>{for(var n in r)t.o(r,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:r[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{void 0!==u&&u.toStringTag&&Object.defineProperty(t,u.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};t.r(e),t.d(e,{S3Uploader:()=>fe,create:()=>ae,destroy:()=>ue,get:()=>ce,getInstance:()=>ie,init:()=>se});const r=function(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)},n=function(t){return t};var o=Math.max;const i="object"==typeof global&&global&&global.Object===Object&&global;var c="object"==typeof self&&self&&self.Object===Object&&self;const a=i||c||Function("return this")();var u=a.Symbol;const s=u;var l=Object.prototype,f=l.hasOwnProperty,p=l.toString,y=s?s.toStringTag:void 0;var d=Object.prototype.toString;var h=s?s.toStringTag:void 0;const v=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":h&&h in Object(t)?function(t){var e=f.call(t,y),r=t[y];try{t[y]=void 0;var n=!0}catch(t){}var o=p.call(t);return n&&(e?t[y]=r:delete t[y]),o}(t):function(t){return d.call(t)}(t)},b=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)},_=function(t){if(!b(t))return!1;var e=v(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e},g=a["__core-js_shared__"];var j,m=(j=/[^.]+$/.exec(g&&g.keys&&g.keys.IE_PROTO||""))?"Symbol(src)_1."+j:"";var O=Function.prototype.toString;var w=/^\[object .+?Constructor\]$/,x=Function.prototype,A=Object.prototype,z=x.toString,P=A.hasOwnProperty,S=RegExp("^"+z.call(P).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");const T=function(t){return!(!b(t)||(e=t,m&&m in e))&&(_(t)?S:w).test(function(t){if(null!=t){try{return O.call(t)}catch(t){}try{return t+""}catch(t){}}return""}(t));var e},U=function(t,e){var r=function(t,e){return null==t?void 0:t[e]}(t,e);return T(r)?r:void 0},F=function(){try{var t=U(Object,"defineProperty");return t({},"",{}),t}catch(t){}}(),C=F?function(t,e){return F(t,"toString",{configurable:!0,enumerable:!1,value:(r=e,function(){return r}),writable:!0});var r}:n;var I=Date.now;const k=($=C,D=0,B=0,function(){var t=I(),e=16-(t-B);if(B=t,e>0){if(++D>=800)return arguments[0]}else D=0;return $.apply(void 0,arguments)});var $,D,B;const M=function(t,e){return k(function(t,e,n){return e=o(void 0===e?t.length-1:e,0),function(){for(var i=arguments,c=-1,a=o(i.length-e,0),u=Array(a);++c<a;)u[c]=i[e+c];c=-1;for(var s=Array(e+1);++c<e;)s[c]=i[c];return s[e]=n(u),r(t,this,s)}}(t,e,n),t+"")},E=function(t,e){return t===e||t!=t&&e!=e},R=function(t,e){for(var r=t.length;r--;)if(E(t[r][0],e))return r;return-1};var X=Array.prototype.splice;function q(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}q.prototype.clear=function(){this.__data__=[],this.size=0},q.prototype.delete=function(t){var e=this.__data__,r=R(e,t);return!(r<0||(r==e.length-1?e.pop():X.call(e,r,1),--this.size,0))},q.prototype.get=function(t){var e=this.__data__,r=R(e,t);return r<0?void 0:e[r][1]},q.prototype.has=function(t){return R(this.__data__,t)>-1},q.prototype.set=function(t,e){var r=this.__data__,n=R(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this};const H=q,L=U(a,"Map"),N=U(Object,"create");var G=Object.prototype.hasOwnProperty;var V=Object.prototype.hasOwnProperty;function W(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}W.prototype.clear=function(){this.__data__=N?N(null):{},this.size=0},W.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},W.prototype.get=function(t){var e=this.__data__;if(N){var r=e[t];return"__lodash_hash_undefined__"===r?void 0:r}return G.call(e,t)?e[t]:void 0},W.prototype.has=function(t){var e=this.__data__;return N?void 0!==e[t]:V.call(e,t)},W.prototype.set=function(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=N&&void 0===e?"__lodash_hash_undefined__":e,this};const J=W,K=function(t,e){var r,n,o=t.__data__;return("string"==(n=typeof(r=e))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?o["string"==typeof e?"string":"hash"]:o.map};function Q(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Q.prototype.clear=function(){this.size=0,this.__data__={hash:new J,map:new(L||H),string:new J}},Q.prototype.delete=function(t){var e=K(this,t).delete(t);return this.size-=e?1:0,e},Q.prototype.get=function(t){return K(this,t).get(t)},Q.prototype.has=function(t){return K(this,t).has(t)},Q.prototype.set=function(t,e){var r=K(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this};const Y=Q;function Z(t){var e=this.__data__=new H(t);this.size=e.size}Z.prototype.clear=function(){this.__data__=new H,this.size=0},Z.prototype.delete=function(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r},Z.prototype.get=function(t){return this.__data__.get(t)},Z.prototype.has=function(t){return this.__data__.has(t)},Z.prototype.set=function(t,e){var r=this.__data__;if(r instanceof H){var n=r.__data__;if(!L||n.length<199)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new Y(n)}return r.set(t,e),this.size=r.size,this};const tt=Z,et=function(t,e,r){"__proto__"==e&&F?F(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r},rt=function(t,e,r){(void 0!==r&&!E(t[e],r)||void 0===r&&!(e in t))&&et(t,e,r)},nt=function(t,e,r){for(var n=-1,o=Object(t),i=r(t),c=i.length;c--;){var a=i[++n];if(!1===e(o[a],a,o))break}return t};var ot="object"==typeof exports&&exports&&!exports.nodeType&&exports,it=ot&&"object"==typeof module&&module&&!module.nodeType&&module,ct=it&&it.exports===ot?a.Buffer:void 0,at=ct?ct.allocUnsafe:void 0;const ut=a.Uint8Array,st=function(t,e){var r,n,o=e?(r=t.buffer,n=new r.constructor(r.byteLength),new ut(n).set(new ut(r)),n):t.buffer;return new t.constructor(o,t.byteOffset,t.length)};var lt=Object.create;const ft=function(){function t(){}return function(e){if(!b(e))return{};if(lt)return lt(e);t.prototype=e;var r=new t;return t.prototype=void 0,r}}(),pt=function(t,e){return function(r){return t(e(r))}}(Object.getPrototypeOf,Object);var yt=Object.prototype;const dt=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||yt)},ht=function(t){return null!=t&&"object"==typeof t},vt=function(t){return ht(t)&&"[object Arguments]"==v(t)};var bt=Object.prototype,_t=bt.hasOwnProperty,gt=bt.propertyIsEnumerable;const jt=vt(function(){return arguments}())?vt:function(t){return ht(t)&&_t.call(t,"callee")&&!gt.call(t,"callee")},mt=Array.isArray,Ot=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991},wt=function(t){return null!=t&&Ot(t.length)&&!_(t)};var xt="object"==typeof exports&&exports&&!exports.nodeType&&exports,At=xt&&"object"==typeof module&&module&&!module.nodeType&&module,zt=At&&At.exports===xt?a.Buffer:void 0;const Pt=(zt?zt.isBuffer:void 0)||function(){return!1};var St=Function.prototype,Tt=Object.prototype,Ut=St.toString,Ft=Tt.hasOwnProperty,Ct=Ut.call(Object);var It={};It["[object Float32Array]"]=It["[object Float64Array]"]=It["[object Int8Array]"]=It["[object Int16Array]"]=It["[object Int32Array]"]=It["[object Uint8Array]"]=It["[object Uint8ClampedArray]"]=It["[object Uint16Array]"]=It["[object Uint32Array]"]=!0,It["[object Arguments]"]=It["[object Array]"]=It["[object ArrayBuffer]"]=It["[object Boolean]"]=It["[object DataView]"]=It["[object Date]"]=It["[object Error]"]=It["[object Function]"]=It["[object Map]"]=It["[object Number]"]=It["[object Object]"]=It["[object RegExp]"]=It["[object Set]"]=It["[object String]"]=It["[object WeakMap]"]=!1;var kt="object"==typeof exports&&exports&&!exports.nodeType&&exports,$t=kt&&"object"==typeof module&&module&&!module.nodeType&&module,Dt=$t&&$t.exports===kt&&i.process,Bt=function(){try{return $t&&$t.require&&$t.require("util").types||Dt&&Dt.binding&&Dt.binding("util")}catch(t){}}(),Mt=Bt&&Bt.isTypedArray;const Et=Mt?function(t){return function(e){return t(e)}}(Mt):function(t){return ht(t)&&Ot(t.length)&&!!It[v(t)]},Rt=function(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]};var Xt=Object.prototype.hasOwnProperty;const qt=function(t,e,r){var n=t[e];Xt.call(t,e)&&E(n,r)&&(void 0!==r||e in t)||et(t,e,r)};var Ht=/^(?:0|[1-9]\d*)$/;const Lt=function(t,e){var r=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==r||"symbol"!=r&&Ht.test(t))&&t>-1&&t%1==0&&t<e};var Nt=Object.prototype.hasOwnProperty;const Gt=function(t,e){var r=mt(t),n=!r&&jt(t),o=!r&&!n&&Pt(t),i=!r&&!n&&!o&&Et(t),c=r||n||o||i,a=c?function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}(t.length,String):[],u=a.length;for(var s in t)!e&&!Nt.call(t,s)||c&&("length"==s||o&&("offset"==s||"parent"==s)||i&&("buffer"==s||"byteLength"==s||"byteOffset"==s)||Lt(s,u))||a.push(s);return a};var Vt=Object.prototype.hasOwnProperty;const Wt=function(t){if(!b(t))return function(t){var e=[];if(null!=t)for(var r in Object(t))e.push(r);return e}(t);var e=dt(t),r=[];for(var n in t)("constructor"!=n||!e&&Vt.call(t,n))&&r.push(n);return r},Jt=function(t){return wt(t)?Gt(t,!0):Wt(t)},Kt=function(t){return function(t,e,r,n){var o=!r;r||(r={});for(var i=-1,c=e.length;++i<c;){var a=e[i],u=n?n(r[a],t[a],a,r,t):void 0;void 0===u&&(u=t[a]),o?et(r,a,u):qt(r,a,u)}return r}(t,Jt(t))},Qt=function(t,e,r,n,o,i,c){var a,u=Rt(t,r),s=Rt(e,r),l=c.get(s);if(l)rt(t,r,l);else{var f=i?i(u,s,r+"",t,e,c):void 0,p=void 0===f;if(p){var y=mt(s),d=!y&&Pt(s),h=!y&&!d&&Et(s);f=s,y||d||h?mt(u)?f=u:ht(a=u)&&wt(a)?f=function(t,e){var r=-1,n=t.length;for(e||(e=Array(n));++r<n;)e[r]=t[r];return e}(u):d?(p=!1,f=function(t,e){if(e)return t.slice();var r=t.length,n=at?at(r):new t.constructor(r);return t.copy(n),n}(s,!0)):h?(p=!1,f=st(s,!0)):f=[]:function(t){if(!ht(t)||"[object Object]"!=v(t))return!1;var e=pt(t);if(null===e)return!0;var r=Ft.call(e,"constructor")&&e.constructor;return"function"==typeof r&&r instanceof r&&Ut.call(r)==Ct}(s)||jt(s)?(f=u,jt(u)?f=Kt(u):b(u)&&!_(u)||(f=function(t){return"function"!=typeof t.constructor||dt(t)?{}:ft(pt(t))}(s))):p=!1}p&&(c.set(s,f),o(f,s,n,i,c),c.delete(s)),rt(t,r,f)}},Yt=function t(e,r,n,o,i){e!==r&&nt(r,(function(c,a){if(i||(i=new tt),b(c))Qt(e,r,a,n,t,o,i);else{var u=o?o(Rt(e,a),c,a+"",e,r,i):void 0;void 0===u&&(u=c),rt(e,a,u)}}),Jt)},Zt=function t(e,r,n,o,i,c){return b(e)&&b(r)&&(c.set(r,e),Yt(e,r,void 0,t,c),c.delete(r)),e},te=(ee=function(t,e,r,n){Yt(t,e,r,n)},M((function(t,e){var r=-1,n=e.length,o=n>1?e[n-1]:void 0,i=n>2?e[2]:void 0;for(o=ee.length>3&&"function"==typeof o?(n--,o):void 0,i&&function(t,e,r){if(!b(r))return!1;var n=typeof e;return!!("number"==n?wt(r)&&Lt(e,r.length):"string"==n&&e in r)&&E(r[e],t)}(e[0],e[1],i)&&(o=n<3?void 0:o,n=1),t=Object(t);++r<n;){var c=e[r];c&&ee(t,c,r,o)}return t})));var ee;const re=M((function(t){return t.push(void 0,Zt),r(te,void 0,t)})),ne={};let oe;function ie(t,e={}){return ne[t]||(ne[t]=ae(t,e)),ne[t]}function ce(t){return Promise.resolve(ae(t))}function ae(t,e={}){return new fe(t,e)}function ue(t){delete ne[t]}function se(t){oe=t,oe.inject("$loader").asImported("s3.uploader")}const le={endpoint:"",subfolder:"",viewerHost:"",starts_with:[],formInputs:{acl:"",bucket:"",key:"",Policy:"","X-Amz-Algorithm":"","X-Amz-Credential":"","X-Amz-Date":"","X-Amz-Signature":""}};class fe extends(Unicorn.mix(class{}).with(Unicorn.EventMixin)){name;options;constructor(t,e={}){super(),this.name=t;const r=oe.data("@s3.uploader."+t)||{};this.options=re({},e,r,le)}async upload(t,e,r={}){const n=new FormData,o=re({},r.formInputs||{},this.options.formInputs);"string"==typeof t&&(t=new Blob([t],{type:r["Content-Type"]||"text/plain"})),(t instanceof Blob||t instanceof File)&&(r["Content-Type"]=r["Content-Type"]||t.type),r.filename&&(r["Content-Disposition"]="attachment; filename*=UTF-8''"+encodeURIComponent(r.filename)),r.key=pe(this.options.subfolder||"")+"/"+pe(e),r.key=pe(r.key),r["Content-Type"]=r["Content-Type"]||void 0,r["Content-Disposition"]=r["Content-Disposition"]||void 0;for(let t in o)n.set(t,o[t]);for(let t of Object.keys(this.options.starts_with))r[t]&&n.set(t,r[t]);n.append("file",t),this.trigger("start",n);try{let t=await oe.inject("$http").post(this.options.endpoint||"",n,{onUploadProgress:t=>{r.onUploadProgress&&r.onUploadProgress(t),this.trigger("upload-progress",t),null!=t.total&&this.trigger("progress",t.loaded/t.total,t)}});const o=this.options.viewerHost+"/"+pe(e);return this.trigger("success",o,t),t.url=o,t}finally{this.trigger("end")}}}function pe(t){return t.replace(/^\/+|\/+$/g,"")}return e})()));
//# sourceMappingURL=main.js.map