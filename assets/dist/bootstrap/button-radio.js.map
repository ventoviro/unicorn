{"version":3,"file":"button-radio.js","names":["ButtonRadio","defaultOptions","selector","buttonClass","activeClass","color","green","red","blue","handle","el","options","u","getBoundedInstance","constructor","element","selectOne","defaultsDeep","wrapper","dataset","fieldInput","querySelector","inputGroup","exists","h","class","radios","querySelectorAll","forEach","radio","button","prepareButton","appendChild","syncState","insertBefore","firstChild","dispatchEvent","Event","colors","Set","input","label","id","classList","add","parseClasses","type","value","innerHTML","$helper","set","inputs","push","buttons","style","display","colorClass","disabled","getAttribute","addEventListener","changed","checked","ele","get","default","remove","className","join","split","filter","t"],"sources":["bootstrap/button-radio.js"],"sourcesContent":["/**\n * Part of unicorn project.\n *\n * @copyright  Copyright (C) 2021 __ORGANIZATION__.\n * @license    __LICENSE__\n */\n\nconst defaultOptions = {\n  selector: '.btn-group .radio',\n  buttonClass: 'btn',\n  activeClass: 'active',\n  color: {\n    'default': 'btn-default btn-outline-secondary',\n    green: 'btn-success',\n    red: 'btn-danger',\n    blue: 'btn-primary'\n  }\n};\n\nexport class ButtonRadio {\n  wrapper = null;\n  radios = [];\n  inputs = [];\n  buttons = [];\n  colors = [];\n\n  static handle(el, options = {}) {\n    return u.getBoundedInstance(el, 'button-radio', (el) => {\n      return new this(el, options);\n    });\n  }\n\n  constructor(selector, options) {\n    this.element = u.selectOne(selector);\n    this.options = options = u.defaultsDeep({}, options, defaultOptions);\n    let wrapper = null;\n\n    // Turn radios into btn-group\n\n    if (this.element.dataset.fieldInput != null) {\n      wrapper = this.element;\n    } else {\n      wrapper = this.element.querySelector('[data-field-input]');\n    }\n\n    this.wrapper = wrapper;\n    let inputGroup = wrapper.querySelector('.btn-group');\n    const exists = inputGroup != null;\n\n    if (!inputGroup) {\n      inputGroup = u.h('div', { class: 'btn-group' })\n    }\n\n    this.radios = wrapper.querySelectorAll('.radio');\n\n    this.radios.forEach(radio => {\n      const button = this.prepareButton(radio, exists);\n\n      if (!exists) {\n        inputGroup.appendChild(button);\n      }\n    });\n\n    this.syncState();\n\n    wrapper.insertBefore(inputGroup, wrapper.firstChild);\n\n    wrapper.dispatchEvent(new Event('button-radio.loaded'));\n\n    // Make color elements unique\n    this.colors = [...new Set(this.colors)];\n  }\n\n  prepareButton(radio, exists = false) {\n    const options = this.options;\n\n    const input = radio.querySelector('input');\n    const label = radio.querySelector('label');\n\n    let button = null;\n\n    if (exists) {\n      button = this.wrapper.querySelector(`[data-for=\"${input.id}\"]`);\n      button.classList.add(...this.parseClasses(`${options.buttonClass} ${options.color['default']}`));\n    } else {\n      button = u.h(\n        'button',\n        {\n          type: 'button',\n          class: `${options.buttonClass} ${options.color['default']}`,\n          'data-value': input.value,\n        },\n        `<span>${label.innerHTML}</span>`\n      );\n    }\n\n    u.$helper.set(button, '__unicorn.input', input);\n    this.inputs.push(input);\n    this.buttons.push(button);\n\n    radio.style.display = 'none';\n\n    // Prepare color schema\n    let color = input.dataset.colorClass;\n\n    if (color == null) {\n      switch (input.value) {\n        case '':\n          color = options.color.blue;\n          break;\n\n        case '0':\n          color = options.color.red;\n          break;\n\n        default:\n          color = options.color.green;\n          break;\n      }\n\n      input.dataset.colorClass = color;\n    }\n    \n    this.colors.push(color);\n\n    if (input.disabled || input.getAttribute('readonly') != null) {\n      button.classList.add('disabled');\n      button.disabled = true;\n    }\n\n    if (input.getAttribute('readonly') != null) {\n      button.classList.add('readonly');\n    }\n\n    // Bind event\n    button.addEventListener('click', () => {\n      if (input.getAttribute('disabled') || input.getAttribute('readonly')) {\n        return;\n      }\n\n      const changed = !input.checked;\n\n      if (changed) {\n        this.inputs.forEach((ele) => {\n          ele.checked = false;\n        });\n\n        input.checked = true;\n\n        this.syncState();\n\n        input.dispatchEvent(new Event('change'));\n        input.dispatchEvent(new Event('input'));\n      }\n    });\n\n    return button;\n  }\n\n  syncState() {\n    const options = this.options;\n\n    this.buttons.forEach((button) => {\n      const input = u.$helper.get(button, '__unicorn.input');\n\n      button.classList.add(...this.parseClasses(options.color.default));\n      button.classList.remove(...this.parseClasses(options.activeClass));\n      button.classList.remove(...this.parseClasses(...this.colors));\n\n      if (input.checked) {\n        button.classList.add(...this.parseClasses(options.activeClass));\n        button.classList.add(...this.parseClasses(input.dataset.colorClass));\n        button.classList.remove(...this.parseClasses(options.color.default));\n      }\n    });\n  }\n\n  parseClasses(...className) {\n    className = className.join(' ');\n    return className.split(' ').filter(t => t !== '');\n  }\n}\n"],"mappings":"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"}