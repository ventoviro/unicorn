{"version":3,"sources":["bootstrap/keep-tab.js"],"names":["System","register","_export","_context","LoadTab","_defineProperty","obj","key","value","arg","input","hint","prim","Symbol","toPrimitive","undefined","res","call","TypeError","String","Number","_toPrimitive","_toPropertyKey","Object","defineProperty","enumerable","configurable","writable","setters","execute","constructor","selector","options","arguments","length","uid","id","$element","this","u","selectOne","tabButtons","querySelectorAll","TAB_ITEM_SELECTOR","storageKey","hashCode","location","href","setTimeout","switchTab","console","warn","bindEvents","forEach","button","addEventListener","window","localStorage","setItem","getButtonHref","dataset","bsTarget","target","findTabButtonByHref","filter","shift","tabTrigger","show","hasTab","getItem","removeItem","tabhref","text","md5"],"mappings":"AAAAA,OAAOC,SAAS,IAAI,SAAUC,EAASC,GAGrC,IAIWC,EAAO,SAAAC,EAAAC,EAAAC,EAAAC,GAAA,OAAAD,EAAA,SAAAE,GAAA,IAAAF,EAAA,SAAAG,EAAAC,GAAA,GAAA,iBAAAD,GAAA,OAAAA,EAAA,OAAAA,EAAA,IAAAE,EAAAF,EAAAG,OAAAC,aAAA,QAAAC,IAAAH,EAAA,CAAA,IAAAI,EAAAJ,EAAAK,KAAAP,EAAAC,GAAA,WAAA,GAAA,iBAAAK,EAAA,OAAAA,EAAA,MAAA,IAAAE,UAAA,+CAAA,CAAA,OAAA,WAAAP,EAAAQ,OAAAC,QAAAV,EAAA,CAAAW,CAAAZ,EAAA,UAAA,MAAA,iBAAAF,EAAAA,EAAAY,OAAAZ,EAAA,CAAAe,CAAAf,MAAAD,EAAAiB,OAAAC,eAAAlB,EAAAC,EAAA,CAAAC,MAAAA,EAAAiB,YAAA,EAAAC,cAAA,EAAAC,UAAA,IAAArB,EAAAC,GAAAC,EAAAF,CAAA,CAAA,OAAAJ,EAAA,eAAA,GAAA,CAAA0B,QAAA,GAAAC,QAAA,WAPpB3B,EAAA,UAAAE,EAAA,MACA0B,YAAAC,GACA,IAAAC,EAAAC,UAAAC,OAAA,QAAAnB,IAAAkB,UAAA,GAAAA,UAAA,GAAA,CAAA,EACAE,EAAAJ,EACA,iBAAAA,IACAI,EAAAH,EAAAG,KAAAJ,EAAAK,IAKE,MAAAC,EAAAC,KAAAD,SAAAE,EAAAC,UAAAT,GACFM,GAIAC,KAAAD,SAAAA,EACAC,KAAAG,WAAAJ,EAAAK,iBAAAJ,KAAAR,YAAAa,mBACAL,KAAAM,WAAA,YAAAN,KAAAO,SAAAC,SAAAC,KAAA,IAAAZ,GACEL,KAAAA,QAAYC,EAAwBO,KAAdN,aACpBgB,YAAUjB,KAEVO,KAAIW,WAAOlB,GACTI,KAAMH,QAAQG,OAAOJ,IAV3BmB,QAAAC,KAAA,qBAAApB,eAmBQ,CACAqB,aALJ,GAAAC,QAAKhB,KAAUC,KAAAG,YAAAa,IACbJ,EAAOK,iBAAO,SAAA,KACdC,OAAAC,aAAAC,QAAApB,KAAAM,WAAAN,KAAAqB,cAAAL,GAAA,GACF,GAQI,CACAK,cAJCf,GACL,OAAKZ,EAAO4B,QAAUC,UAAAP,EAAAM,QAAAE,QAAAR,EAAAP,IAKlB,CACAgB,oBAFahB,GAGX,OAFCE,EAAAA,UAAWX,KAAAD,SAAAK,iBAAAJ,KAAAR,YAAAa,oBAAAqB,QAAAV,GACfA,EAAKtB,OAAae,IAIlBM,EAAQpC,QAAUwB,WAAaa,GAG9BE,EAAOC,QAAaC,SAAQX,KAC7BkB,OAEC,CAENN,YAAAA,GACE,MAAAO,EAAcN,KAAQC,oBAAmBD,GAC3CM,GAEAH,IAAAA,UAAAA,IAAoBhB,GAAMoB,MACpB,CAEAC,OAEArB,GADE,OAGoC,MAAlCO,KAAMS,oBAAiBhB,EAF3B,CAEAE,YAKF,GACCgB,aAAOI,QAAA/B,KAAAM,YAAA,CACZ,IAAAN,KAAA8B,OAAAX,aAAAY,QAAA/B,KAAAM,aAEA,OANYa,aAAaa,WAAWhC,KAAKM,aAMzC,EAIF,MAAA2B,EAAAd,aAAAY,QAAA/B,KAAAM,YAEIN,KAAM4B,YAAaK,EAHb,CACF,CAEA1B,SAAS2B,GAOf,OAAAjC,EAAAkC,IAAAD,EACF,IAEAnE,EAAAD,EAAA,oBAAA,kFACA,EAEA","file":"keep-tab.js","sourcesContent":["/**\n * Part of unicorn project.\n *\n * @copyright  Copyright (C) 2021 __ORGANIZATION__.\n * @license    __LICENSE__\n */\n\nexport class LoadTab {\n  static TAB_ITEM_SELECTOR = '[data-toggle=tab],[data-bs-toggle=tab],[data-toggle=pill],[data-bs-toggle=pill]';\n\n  /**\n   * Class init.\n   *\n   * @param {HTMLElement|string} selector\n   * @param {Object}      options\n   *\n   * @constructor\n   */\n  constructor(selector, options = {}) {\n    let uid = selector;\n\n    if (typeof selector === 'object') {\n      uid = options.uid || selector.id;\n    }\n\n    const $element = this.$element = u.selectOne(selector);\n\n    if (!$element) {\n      console.warn(`[KeepTab] Element ${selector} not found.`);\n      return;\n    }\n\n    this.$element = $element;\n    this.tabButtons = $element.querySelectorAll(this.constructor.TAB_ITEM_SELECTOR);\n\n    this.storageKey = 'tab-href-' + this.hashCode(location.href + ':' + uid);\n    this.options = options;\n\n    this.bindEvents();\n\n    setTimeout(() => {\n      this.switchTab();\n    }, this.options.delay || 0);\n  }\n\n  bindEvents() {\n    [].forEach.call(this.tabButtons, (button) => {\n      button.addEventListener('click', () => {\n        // Store the selected tab href in localstorage\n        window.localStorage.setItem(this.storageKey, this.getButtonHref(button));\n      });\n    });\n  }\n\n  getButtonHref(button) {\n    return button.dataset.bsTarget || button.dataset.target || button.href\n  }\n\n  findTabButtonByHref(href) {\n    return u.selectAll(this.$element.querySelectorAll(this.constructor.TAB_ITEM_SELECTOR))\n      .filter((button) => {\n        if (button.href === href) {\n          return true;\n        }\n\n        if (button.dataset.bsTarget === href) {\n          return true;\n        }\n\n        return button.dataset.target === href;\n      })\n      .shift();\n  }\n\n  /**\n   * Active tab.\n   *\n   * @param {string} href\n   */\n  activateTab(href) {\n    const tabTrigger = this.findTabButtonByHref(href);\n\n    if (tabTrigger) {\n      (new bootstrap.Tab(tabTrigger)).show();\n    }\n  }\n\n  /**\n   * Has tab.\n   *\n   * @param {string} href\n   *\n   * @returns {*}\n   */\n  hasTab(href) {\n    return this.findTabButtonByHref(href) != null;\n  }\n\n  /**\n   * Switch tab.\n   *\n   * @returns {boolean}\n   */\n  switchTab() {\n    if (localStorage.getItem(this.storageKey)) {\n      // When moving from tab area to a different view\n      if (!this.hasTab(localStorage.getItem(this.storageKey))) {\n        localStorage.removeItem(this.storageKey);\n        return true;\n      }\n\n      // Clean default tabs\n      // u.selectOne(this.$element, '[data-toggle=\"tab\"], [data-bs-toggle=tab]')\n      // this.$element.querySelector('a[data-toggle=\"tab\"]').parent().removeClass('active');\n\n      const tabhref = localStorage.getItem(this.storageKey);\n\n      // Add active attribute for selected tab indicated by url\n      this.activateTab(tabhref);\n\n      // Check whether internal tab is selected (in format <tabname>-<id>)\n      // const seperatorIndex = tabhref.indexOf('-');\n      //\n      // if (seperatorIndex !== -1) {\n      //   const singular = tabhref.substring(0, seperatorIndex);\n      //   const plural = singular + 's';\n      //\n      //   this.activateTab(plural);\n      // }\n    }\n  }\n\n  /**\n   * Hash code.\n   *\n   * @param {String} text\n   *\n   * @returns {number}\n   */\n  hashCode(text) {\n    return u.md5(text);\n  }\n}\n"]}