!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.CascadeSelect=t():e.CascadeSelect=t()}(self,(()=>(()=>{"use strict";var e={944:(e,t)=>{t.A=class{}},610:(e,t)=>{t.A=function(e){return function(...t){let i=new e(...t);const s=e.prototype;let l={};return Object.getOwnPropertyNames(s).forEach((function(e){if("constructor"===e)return;const t=Object.getOwnPropertyDescriptor(s,e);void 0!==t.value?"function"==typeof t.value&&(l[e]=t.value):(t.get||t.set)&&Object.defineProperty(l,e,{get:t.get,set:t.set})})),Object.assign(l,i)}}}},t={};function i(s){var l=t[s];if(void 0!==l)return l.exports;var o=t[s]={exports:{}};return e[s](o,o.exports,i),o.exports}i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var s={};i.r(s);var l,o=i(944),n=i(610);const a={id:"",selected:"",path:[],ignoreSelf:null,placeholder:"- Select -",placeholders:[],ajaxUrl:"",ajaxValueField:"value",source:[],labels:[],labelWidth:"col-md-3",fieldWidth:"col",readonly:!1,disabled:!1,valueField:"id",textField:"title",horizontal:null,horizontalColWidth:null,defaultValue:"",onSelectInit:()=>{},onChange:()=>{},onValueInit:()=>{}};let r=class extends o.A{options;el;canModify=!1;lists=[];ajaxUrl="";values=[];constructor(e={}){super(),this.options=u.defaultsDeep({},e,a),this.options.id=this.options.id||"cascade-select-"+u.uid()}init(){this.canModify=!this.options.readonly&&!this.options.disabled,this.ajaxUrl=this.options.ajaxUrl,this.values=this.options.path.slice().map(String);let e=this.options.path.slice();0===e.length?e=[null]:e.unshift(null);let t=Promise.resolve(),i=null;e.forEach(((e,s)=>{t=t.then((()=>this.loadItems(e,s).then((e=>{e.length>0&&this.lists.push(e)})))),i=e})),this.el=this.$el,u.module(this.$el,"cascade.select",(()=>this)),this.valueInit(this.$el,i,e)}getLabel(e){return this.options.labels[e]||`Level ${e+1}`}getId(e){return`${this.options.id}__level-${e}`}getListValue(e){return this.values[e]||""}isSelected(e,t){return String(this.getListValue(e))===String(t[this.options.valueField])}getFinalValue(){const e=this.values.slice();if(0===e.length)return this.options.defaultValue;const t=e.filter((e=>null!=e)).filter((e=>""!==e)).pop();return null==t?this.options.defaultValue:t}getLevel(){return this.values.length}async onChange(e,t){const i=t.target;this.values[e]=i.value,this.options.onChange(t),t.stopPropagation();const s=new CustomEvent("change",{detail:{el:i,component:this,value:i.value,path:this.values}});if(this.el?.dispatchEvent(s),""===i.value)return this.lists.splice(e+1),void this.values.splice(e+1);let l=await this.loadItems(i.value,e);this.lists.splice(e+1),this.values.splice(e+1),l.length>0&&this.lists.push(l)}async loadItems(e,t){if(this.ajaxUrl){let t=await u.$http.get(this.ajaxUrl,{params:{[this.options.ajaxValueField]:e,self:this.options.ignoreSelf||null}});return await t.data.data}return e?Promise.resolve(this.handleSourceItems(this.findFromList(this.lists[t-1]||[],e)?.children||[])):Promise.resolve(this.handleSourceItems(this.options.source))}valueInit(e,t,i){const s=new CustomEvent("value.init",{detail:{el:e,component:this,value:t,path:i}});this.options.onSelectInit(s),this.$el.dispatchEvent(s)}selectInit(e){const t=new CustomEvent("select.init",{detail:{el:e,component:this}});this.options.onSelectInit(t),this.$el.dispatchEvent(t)}handleSourceItems(e){return e.map((e=>({[this.options.valueField]:e.value[this.options.valueField],[this.options.textField]:e.value[this.options.textField],children:e.children}))).filter((e=>this.options.ignoreSelf?e[this.options.valueField]!=this.options.ignoreSelf:e))}findFromList(e,t){return e.filter((e=>e[this.options.valueField]==t)).shift()}getPlaceholder(e){return this.options.placeholders[e]?this.options.placeholders[e]:this.options.placeholder}};return r=function(e,t,i,s){var l,o=arguments.length,n=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var a=e.length-1;a>=0;a--)(l=e[a])&&(n=(o<3?l(n):o>3?l(t,i,n):l(t,i))||n);return o>3&&n&&Object.defineProperty(t,i,n),n}([n.A,function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}("design:paramtypes",["function"==typeof(l="undefined"!=typeof Partial&&Partial)?l:Object])],r),S.import("@main").then((()=>{u.loadAlpine((()=>{Alpine.data("CascadeSelect",r)}))})),s})()));
//# sourceMappingURL=main.js.map