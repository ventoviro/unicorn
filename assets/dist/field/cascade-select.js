!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var n=e();for(var r in n)("object"==typeof exports?exports:t)[r]=n[r]}}(self,(()=>(()=>{"use strict";var t={};(t=>{void 0!==a&&a.toStringTag&&Object.defineProperty(t,a.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})})(t);const e=function(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)},n=function(t){return t};var r=Math.max;const o="object"==typeof global&&global&&global.Object===Object&&global;var i="object"==typeof self&&self&&self.Object===Object&&self;const s=o||i||Function("return this")();var a=s.Symbol;const l=a;var c=Object.prototype,p=c.hasOwnProperty,h=c.toString,f=l?l.toStringTag:void 0;var d=Object.prototype.toString;var v=l?l.toStringTag:void 0;const y=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":v&&v in Object(t)?function(t){var e=p.call(t,f),n=t[f];try{t[f]=void 0;var r=!0}catch(t){}var o=h.call(t);return r&&(e?t[f]=n:delete t[f]),o}(t):function(t){return d.call(t)}(t)},_=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)},b=function(t){if(!_(t))return!1;var e=y(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e},g=s["__core-js_shared__"];var j,m=(j=/[^.]+$/.exec(g&&g.keys&&g.keys.IE_PROTO||""))?"Symbol(src)_1."+j:"";var O=Function.prototype.toString;var x=/^\[object .+?Constructor\]$/,w=Function.prototype,A=Object.prototype,F=w.toString,z=A.hasOwnProperty,P=RegExp("^"+F.call(z).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");const I=function(t){return!(!_(t)||(e=t,m&&m in e))&&(b(t)?P:x).test(function(t){if(null!=t){try{return O.call(t)}catch(t){}try{return t+""}catch(t){}}return""}(t));var e},U=function(t,e){var n=function(t,e){return null==t?void 0:t[e]}(t,e);return I(n)?n:void 0},$=function(){try{var t=U(Object,"defineProperty");return t({},"",{}),t}catch(t){}}(),E=$?function(t,e){return $(t,"toString",{configurable:!0,enumerable:!1,value:(n=e,function(){return n}),writable:!0});var n}:n;var T=Date.now;const C=(V=E,L=0,M=0,function(){var t=T(),e=16-(t-M);if(M=t,e>0){if(++L>=800)return arguments[0]}else L=0;return V.apply(void 0,arguments)});var V,L,M;const B=function(t,o){return C(function(t,n,o){return n=r(void 0===n?t.length-1:n,0),function(){for(var i=arguments,s=-1,a=r(i.length-n,0),l=Array(a);++s<a;)l[s]=i[n+s];s=-1;for(var u=Array(n+1);++s<n;)u[s]=i[s];return u[n]=o(l),e(t,this,u)}}(t,o,n),t+"")},k=function(t,e){return t===e||t!=t&&e!=e},W=function(t,e){for(var n=t.length;n--;)if(k(t[n][0],e))return n;return-1};var D=Array.prototype.splice;function R(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}R.prototype.clear=function(){this.__data__=[],this.size=0},R.prototype.delete=function(t){var e=this.__data__,n=W(e,t);return!(n<0||(n==e.length-1?e.pop():D.call(e,n,1),--this.size,0))},R.prototype.get=function(t){var e=this.__data__,n=W(e,t);return n<0?void 0:e[n][1]},R.prototype.has=function(t){return W(this.__data__,t)>-1},R.prototype.set=function(t,e){var n=this.__data__,r=W(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this};const q=R,N=U(s,"Map"),G=U(Object,"create");var H=Object.prototype.hasOwnProperty;var J=Object.prototype.hasOwnProperty;function K(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}K.prototype.clear=function(){this.__data__=G?G(null):{},this.size=0},K.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},K.prototype.get=function(t){var e=this.__data__;if(G){var n=e[t];return"__lodash_hash_undefined__"===n?void 0:n}return H.call(e,t)?e[t]:void 0},K.prototype.has=function(t){var e=this.__data__;return G?void 0!==e[t]:J.call(e,t)},K.prototype.set=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=G&&void 0===e?"__lodash_hash_undefined__":e,this};const Q=K,X=function(t,e){var n,r,o=t.__data__;return("string"==(r=typeof(n=e))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?o["string"==typeof e?"string":"hash"]:o.map};function Y(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}Y.prototype.clear=function(){this.size=0,this.__data__={hash:new Q,map:new(N||q),string:new Q}},Y.prototype.delete=function(t){var e=X(this,t).delete(t);return this.size-=e?1:0,e},Y.prototype.get=function(t){return X(this,t).get(t)},Y.prototype.has=function(t){return X(this,t).has(t)},Y.prototype.set=function(t,e){var n=X(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this};const Z=Y;function tt(t){var e=this.__data__=new q(t);this.size=e.size}tt.prototype.clear=function(){this.__data__=new q,this.size=0},tt.prototype.delete=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n},tt.prototype.get=function(t){return this.__data__.get(t)},tt.prototype.has=function(t){return this.__data__.has(t)},tt.prototype.set=function(t,e){var n=this.__data__;if(n instanceof q){var r=n.__data__;if(!N||r.length<199)return r.push([t,e]),this.size=++n.size,this;n=this.__data__=new Z(r)}return n.set(t,e),this.size=n.size,this};const et=tt,nt=function(t,e,n){"__proto__"==e&&$?$(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n},rt=function(t,e,n){(void 0!==n&&!k(t[e],n)||void 0===n&&!(e in t))&&nt(t,e,n)},ot=function(t,e,n){for(var r=-1,o=Object(t),i=n(t),s=i.length;s--;){var a=i[++r];if(!1===e(o[a],a,o))break}return t};var it="object"==typeof exports&&exports&&!exports.nodeType&&exports,st=it&&"object"==typeof module&&module&&!module.nodeType&&module,at=st&&st.exports===it?s.Buffer:void 0,lt=at?at.allocUnsafe:void 0;const ut=s.Uint8Array,ct=function(t,e){var n,r,o=e?(n=t.buffer,r=new n.constructor(n.byteLength),new ut(r).set(new ut(n)),r):t.buffer;return new t.constructor(o,t.byteOffset,t.length)};var pt=Object.create;const ht=function(){function t(){}return function(e){if(!_(e))return{};if(pt)return pt(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}(),ft=function(t,e){return function(n){return t(e(n))}}(Object.getPrototypeOf,Object);var dt=Object.prototype;const vt=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||dt)},yt=function(t){return null!=t&&"object"==typeof t},_t=function(t){return yt(t)&&"[object Arguments]"==y(t)};var bt=Object.prototype,gt=bt.hasOwnProperty,jt=bt.propertyIsEnumerable;const mt=_t(function(){return arguments}())?_t:function(t){return yt(t)&&gt.call(t,"callee")&&!jt.call(t,"callee")},Ot=Array.isArray,xt=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991},St=function(t){return null!=t&&xt(t.length)&&!b(t)};var wt="object"==typeof exports&&exports&&!exports.nodeType&&exports,At=wt&&"object"==typeof module&&module&&!module.nodeType&&module,Ft=At&&At.exports===wt?s.Buffer:void 0;const zt=(Ft?Ft.isBuffer:void 0)||function(){return!1};var Pt=Function.prototype,It=Object.prototype,Ut=Pt.toString,$t=It.hasOwnProperty,Et=Ut.call(Object);var Tt={};Tt["[object Float32Array]"]=Tt["[object Float64Array]"]=Tt["[object Int8Array]"]=Tt["[object Int16Array]"]=Tt["[object Int32Array]"]=Tt["[object Uint8Array]"]=Tt["[object Uint8ClampedArray]"]=Tt["[object Uint16Array]"]=Tt["[object Uint32Array]"]=!0,Tt["[object Arguments]"]=Tt["[object Array]"]=Tt["[object ArrayBuffer]"]=Tt["[object Boolean]"]=Tt["[object DataView]"]=Tt["[object Date]"]=Tt["[object Error]"]=Tt["[object Function]"]=Tt["[object Map]"]=Tt["[object Number]"]=Tt["[object Object]"]=Tt["[object RegExp]"]=Tt["[object Set]"]=Tt["[object String]"]=Tt["[object WeakMap]"]=!1;var Ct="object"==typeof exports&&exports&&!exports.nodeType&&exports,Vt=Ct&&"object"==typeof module&&module&&!module.nodeType&&module,Lt=Vt&&Vt.exports===Ct&&o.process,Mt=function(){try{return Vt&&Vt.require&&Vt.require("util").types||Lt&&Lt.binding&&Lt.binding("util")}catch(t){}}(),Bt=Mt&&Mt.isTypedArray;const kt=Bt?function(t){return function(e){return t(e)}}(Bt):function(t){return yt(t)&&xt(t.length)&&!!Tt[y(t)]},Wt=function(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]};var Dt=Object.prototype.hasOwnProperty;const Rt=function(t,e,n){var r=t[e];Dt.call(t,e)&&k(r,n)&&(void 0!==n||e in t)||nt(t,e,n)};var qt=/^(?:0|[1-9]\d*)$/;const Nt=function(t,e){var n=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==n||"symbol"!=n&&qt.test(t))&&t>-1&&t%1==0&&t<e};var Gt=Object.prototype.hasOwnProperty;const Ht=function(t,e){var n=Ot(t),r=!n&&mt(t),o=!n&&!r&&zt(t),i=!n&&!r&&!o&&kt(t),s=n||r||o||i,a=s?function(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}(t.length,String):[],l=a.length;for(var u in t)!e&&!Gt.call(t,u)||s&&("length"==u||o&&("offset"==u||"parent"==u)||i&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||Nt(u,l))||a.push(u);return a};var Jt=Object.prototype.hasOwnProperty;const Kt=function(t){if(!_(t))return function(t){var e=[];if(null!=t)for(var n in Object(t))e.push(n);return e}(t);var e=vt(t),n=[];for(var r in t)("constructor"!=r||!e&&Jt.call(t,r))&&n.push(r);return n},Qt=function(t){return St(t)?Ht(t,!0):Kt(t)},Xt=function(t){return function(t,e,n,r){var o=!n;n||(n={});for(var i=-1,s=e.length;++i<s;){var a=e[i],l=r?r(n[a],t[a],a,n,t):void 0;void 0===l&&(l=t[a]),o?nt(n,a,l):Rt(n,a,l)}return n}(t,Qt(t))},Yt=function(t,e,n,r,o,i,s){var a,l=Wt(t,n),u=Wt(e,n),c=s.get(u);if(c)rt(t,n,c);else{var p=i?i(l,u,n+"",t,e,s):void 0,h=void 0===p;if(h){var f=Ot(u),d=!f&&zt(u),v=!f&&!d&&kt(u);p=u,f||d||v?Ot(l)?p=l:yt(a=l)&&St(a)?p=function(t,e){var n=-1,r=t.length;for(e||(e=Array(r));++n<r;)e[n]=t[n];return e}(l):d?(h=!1,p=function(t,e){if(e)return t.slice();var n=t.length,r=lt?lt(n):new t.constructor(n);return t.copy(r),r}(u,!0)):v?(h=!1,p=ct(u,!0)):p=[]:function(t){if(!yt(t)||"[object Object]"!=y(t))return!1;var e=ft(t);if(null===e)return!0;var n=$t.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&Ut.call(n)==Et}(u)||mt(u)?(p=l,mt(l)?p=Xt(l):_(l)&&!b(l)||(p=function(t){return"function"!=typeof t.constructor||vt(t)?{}:ht(ft(t))}(u))):h=!1}h&&(s.set(u,p),o(p,u,r,i,s),s.delete(u)),rt(t,n,p)}},Zt=function t(e,n,r,o,i){e!==n&&ot(n,(function(s,a){if(i||(i=new et),_(s))Yt(e,n,a,r,t,o,i);else{var l=o?o(Wt(e,a),s,a+"",e,n,i):void 0;void 0===l&&(l=s),rt(e,a,l)}}),Qt)},te=function t(e,n,r,o,i,s){return _(e)&&_(n)&&(s.set(n,e),Zt(e,n,void 0,t,s),s.delete(n)),e},ee=(ne=function(t,e,n,r){Zt(t,e,n,r)},B((function(t,e){var n=-1,r=e.length,o=r>1?e[r-1]:void 0,i=r>2?e[2]:void 0;for(o=ne.length>3&&"function"==typeof o?(r--,o):void 0,i&&function(t,e,n){if(!_(n))return!1;var r=typeof e;return!!("number"==r?St(n)&&Nt(e,n.length):"string"==r&&e in n)&&k(n[e],t)}(e[0],e[1],i)&&(o=r<3?void 0:o,r=1),t=Object(t);++n<r;){var s=e[n];s&&ne(t,s,n,o)}return t})));var ne;const re=B((function(t){return t.push(void 0,te),e(ee,void 0,t)}));return S.import("@main").then((()=>{u.loadAlpine((()=>{Alpine.data("CascadeSelect",(t=>({options:{id:"cascade-select-"+u.uid(),selected:"",path:[],ignoreSelf:null,placeholder:"- Select -",placeholders:[],ajaxUrl:"",ajaxValueField:"value",source:[],labels:[],labelWidth:"col-md-3",fieldWidth:"col",readonly:!1,disabled:!1,valueField:"id",textField:"title",horizontal:null,horizontalColWidth:null,defaultValue:"",onSelectInit:()=>{},onChange:()=>{},onValueInit:()=>{}},el:null,canModify:!0,lists:[],ajaxUrl:"",values:[],init(){this.options=re(t,this.options),this.canModify=!this.options.readonly&&!this.options.disabled,this.ajaxUrl=this.options.ajaxUrl,this.values=this.options.path.slice().map(String);let e=this.options.path.slice();0===e.length?e=[null]:e.unshift(null);let n,r=Promise.resolve();e.forEach(((t,e)=>{r=r.then((()=>this.loadItems(t,e).then((t=>{t.length>0&&this.lists.push(t)})))),n=t})),this.el=this.$el,u.module(this.el,"cascade.select",(()=>this)),this.valueInit(this.$el,n,e)},getLabel(t){return this.options.labels[t]||`Level ${t+1}`},getId(t){return`${this.options.id}__level-${t}`},getListValue(t){return this.values[t]||""},isSelected(t,e){return String(this.getListValue(t))===String(e[this.options.valueField])},getFinalValue(){const t=this.values.slice();if(0===t.length)return this.options.defaultValue;const e=t.filter((t=>null!=t)).filter((t=>""!==t)).pop();return null==e?this.options.defaultValue:e},getLevel(){return this.values.length},onChange(t,e){const n=e.target;this.values[t]=n.value,this.options.onChange(e),e.stopPropagation();const r=new CustomEvent("change",{detail:{el:n,component:this,value:n.value,path:this.values}});if(this.el.dispatchEvent(r),""===n.value)return this.lists.splice(t+1),void this.values.splice(t+1);this.loadItems(n.value,t).then((e=>{this.lists.splice(t+1),this.values.splice(t+1),e.length>0&&this.lists.push(e)}))},loadItems(t,e){return this.ajaxUrl?u.$http.get(this.ajaxUrl,{params:{[this.options.ajaxValueField]:t,self:this.options.ignoreSelf||null}}).then((t=>t.data.data)):t?Promise.resolve(this.handleSourceItems((null===(n=this.findFromList(this.lists[e-1]||[],t))||void 0===n?void 0:n.children)||[])):Promise.resolve(this.handleSourceItems(this.options.source));var n},valueInit(t,e,n){const r=new CustomEvent("value.init",{detail:{el:t,component:this,value:e,path:n}});this.options.onSelectInit(r),this.el.dispatchEvent(r)},selectInit(t){const e=new CustomEvent("select.init",{detail:{el:t,component:this}});this.options.onSelectInit(e),this.el.dispatchEvent(e)},handleSourceItems(t){return t.map((t=>({[this.options.valueField]:t.value[this.options.valueField],[this.options.textField]:t.value[this.options.textField],children:t.children}))).filter((t=>this.options.ignoreSelf?t[this.options.valueField]!=this.options.ignoreSelf:t))},findFromList(t,e){return t.filter((t=>t[this.options.valueField]==e)).shift()},getPlaceholder(t){return this.options.placeholders[t]?this.options.placeholders[t]:this.options.placeholder}})))}))})),t})()));
//# sourceMappingURL=cascade-select.js.map