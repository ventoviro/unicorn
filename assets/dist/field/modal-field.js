!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var r=e();for(var n in r)("object"==typeof exports?exports:t)[n]=r[n]}}(window,(function(){return function(t){var e={};function r(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(n,o,function(e){return t[e]}.bind(null,o));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=6)}([function(t,e,r){"use strict";var n=r(1),o="object"==typeof self&&self&&self.Object===Object&&self,u=n.a||o||Function("return this")();e.a=u},function(t,e,r){"use strict";(function(t){var r="object"==typeof t&&t&&t.Object===Object&&t;e.a=r}).call(this,r(7))},function(t,e,r){"use strict";(function(t){var n=r(1),o="object"==typeof exports&&exports&&!exports.nodeType&&exports,u=o&&"object"==typeof t&&t&&!t.nodeType&&t,i=u&&u.exports===o&&n.a.process,c=function(){try{var t=u&&u.require&&u.require("util").types;return t||i&&i.binding&&i.binding("util")}catch(t){}}();e.a=c}).call(this,r(3)(t))},function(t,e){t.exports=function(t){if(!t.webpackPolyfill){var e=Object.create(t);e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),Object.defineProperty(e,"exports",{enumerable:!0}),e.webpackPolyfill=1}return e}},function(t,e,r){"use strict";(function(t){var n=r(0),o=r(5),u="object"==typeof exports&&exports&&!exports.nodeType&&exports,i=u&&"object"==typeof t&&t&&!t.nodeType&&t,c=i&&i.exports===u?n.a.Buffer:void 0,a=(c?c.isBuffer:void 0)||o.a;e.a=a}).call(this,r(3)(t))},function(t,e,r){"use strict";e.a=function(){return!1}},function(t,e,r){t.exports=r(8)},function(t,e){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(t){"object"==typeof window&&(r=window)}t.exports=r},function(t,e,r){"use strict";r.r(e);var n=r(0),o=n.a.Symbol,i=Object.prototype,c=i.hasOwnProperty,a=i.toString,l=o?o.toStringTag:void 0;var f=function(t){var e=c.call(t,l),r=t[l];try{t[l]=void 0;var n=!0}catch(t){}var o=a.call(t);return n&&(e?t[l]=r:delete t[l]),o},p=Object.prototype.toString;var s=function(t){return p.call(t)},y=o?o.toStringTag:void 0;var v=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":y&&y in Object(t)?f(t):s(t)};var b=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)};var d,h=function(t){if(!b(t))return!1;var e=v(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e},j=n.a["__core-js_shared__"],g=(d=/[^.]+$/.exec(j&&j.keys&&j.keys.IE_PROTO||""))?"Symbol(src)_1."+d:"";var m=function(t){return!!g&&g in t},O=Function.prototype.toString;var _=function(t){if(null!=t){try{return O.call(t)}catch(t){}try{return t+""}catch(t){}}return""},w=/^\[object .+?Constructor\]$/,S=Function.prototype,x=Object.prototype,P=S.toString,E=x.hasOwnProperty,k=RegExp("^"+P.call(E).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var A=function(t){return!(!b(t)||m(t))&&(h(t)?k:w).test(_(t))};var q=function(t,e){return null==t?void 0:t[e]};var T=function(t,e){var r=q(t,e);return A(r)?r:void 0},R=function(){try{var t=T(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();var $=function(t,e,r){"__proto__"==e&&R?R(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r};var F=function(t,e){return t===e||t!=t&&e!=e},C=Object.prototype.hasOwnProperty;var M=function(t,e,r){var n=t[e];C.call(t,e)&&F(n,r)&&(void 0!==r||e in t)||$(t,e,r)};var L=function(t,e,r,n){var o=!r;r||(r={});for(var u=-1,i=e.length;++u<i;){var c=e[u],a=n?n(r[c],t[c],c,r,t):void 0;void 0===a&&(a=t[c]),o?$(r,c,a):M(r,c,a)}return r};var U=function(t){return t};var I=function(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)},B=Math.max;var D=function(t,e,r){return e=B(void 0===e?t.length-1:e,0),function(){for(var n=arguments,o=-1,u=B(n.length-e,0),i=Array(u);++o<u;)i[o]=n[e+o];o=-1;for(var c=Array(e+1);++o<e;)c[o]=n[o];return c[e]=r(i),I(t,this,c)}};var N=function(t){return function(){return t}},H=R?function(t,e){return R(t,"toString",{configurable:!0,enumerable:!1,value:N(e),writable:!0})}:U,z=Date.now;var G=function(t){var e=0,r=0;return function(){var n=z(),o=16-(n-r);if(r=n,o>0){if(++e>=800)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}(H);var J=function(t,e){return G(D(t,e,U),t+"")};var K=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991};var V=function(t){return null!=t&&K(t.length)&&!h(t)},W=/^(?:0|[1-9]\d*)$/;var Q=function(t,e){var r=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==r||"symbol"!=r&&W.test(t))&&t>-1&&t%1==0&&t<e};var X=function(t,e,r){if(!b(r))return!1;var n=typeof e;return!!("number"==n?V(r)&&Q(e,r.length):"string"==n&&e in r)&&F(r[e],t)};var Y=function(t){return J((function(e,r){var n=-1,o=r.length,u=o>1?r[o-1]:void 0,i=o>2?r[2]:void 0;for(u=t.length>3&&"function"==typeof u?(o--,u):void 0,i&&X(r[0],r[1],i)&&(u=o<3?void 0:u,o=1),e=Object(e);++n<o;){var c=r[n];c&&t(e,c,n,u)}return e}))};var Z=function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n};var tt=function(t){return null!=t&&"object"==typeof t};var et=function(t){return tt(t)&&"[object Arguments]"==v(t)},rt=Object.prototype,nt=rt.hasOwnProperty,ot=rt.propertyIsEnumerable,ut=et(function(){return arguments}())?et:function(t){return tt(t)&&nt.call(t,"callee")&&!ot.call(t,"callee")},it=Array.isArray,ct=r(4),at={};at["[object Float32Array]"]=at["[object Float64Array]"]=at["[object Int8Array]"]=at["[object Int16Array]"]=at["[object Int32Array]"]=at["[object Uint8Array]"]=at["[object Uint8ClampedArray]"]=at["[object Uint16Array]"]=at["[object Uint32Array]"]=!0,at["[object Arguments]"]=at["[object Array]"]=at["[object ArrayBuffer]"]=at["[object Boolean]"]=at["[object DataView]"]=at["[object Date]"]=at["[object Error]"]=at["[object Function]"]=at["[object Map]"]=at["[object Number]"]=at["[object Object]"]=at["[object RegExp]"]=at["[object Set]"]=at["[object String]"]=at["[object WeakMap]"]=!1;var lt=function(t){return tt(t)&&K(t.length)&&!!at[v(t)]};var ft=function(t){return function(e){return t(e)}},pt=r(2),st=pt.a&&pt.a.isTypedArray,yt=st?ft(st):lt,vt=Object.prototype.hasOwnProperty;var bt=function(t,e){var r=it(t),n=!r&&ut(t),o=!r&&!n&&Object(ct.a)(t),u=!r&&!n&&!o&&yt(t),i=r||n||o||u,c=i?Z(t.length,String):[],a=c.length;for(var l in t)!e&&!vt.call(t,l)||i&&("length"==l||o&&("offset"==l||"parent"==l)||u&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||Q(l,a))||c.push(l);return c},dt=Object.prototype;var ht=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||dt)};var jt=function(t){var e=[];if(null!=t)for(var r in Object(t))e.push(r);return e},gt=Object.prototype.hasOwnProperty;var mt=function(t){if(!b(t))return jt(t);var e=ht(t),r=[];for(var n in t)("constructor"!=n||!e&&gt.call(t,n))&&r.push(n);return r};var Ot=function(t){return V(t)?bt(t,!0):mt(t)},_t=Y((function(t,e,r,n){L(e,Ot(e),t,n)}));var wt=function(t,e){return function(r){return t(e(r))}},St=wt(Object.getPrototypeOf,Object),xt=Function.prototype,Pt=Object.prototype,Et=xt.toString,kt=Pt.hasOwnProperty,At=Et.call(Object);var qt=function(t){if(!tt(t)||"[object Object]"!=v(t))return!1;var e=St(t);if(null===e)return!0;var r=kt.call(e,"constructor")&&e.constructor;return"function"==typeof r&&r instanceof r&&Et.call(r)==At};var Tt=function(t){if(!tt(t))return!1;var e=v(t);return"[object Error]"==e||"[object DOMException]"==e||"string"==typeof t.message&&"string"==typeof t.name&&!qt(t)},Rt=J((function(t,e){try{return I(t,void 0,e)}catch(t){return Tt(t)?t:new Error(t)}}));var $t=function(t,e){for(var r=-1,n=null==t?0:t.length,o=Array(n);++r<n;)o[r]=e(t[r],r,t);return o};var Ft=function(t,e){return $t(e,(function(e){return t[e]}))},Ct=Object.prototype,Mt=Ct.hasOwnProperty;var Lt=function(t,e,r,n){return void 0===t||F(t,Ct[r])&&!Mt.call(n,r)?e:t},Ut={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"};var It=function(t){return"\\"+Ut[t]},Bt=wt(Object.keys,Object),Dt=Object.prototype.hasOwnProperty;var Nt=function(t){if(!ht(t))return Bt(t);var e=[];for(var r in Object(t))Dt.call(t,r)&&"constructor"!=r&&e.push(r);return e};var Ht=function(t){return V(t)?bt(t):Nt(t)},zt=/<%=([\s\S]+?)%>/g;var Gt=function(t){return function(e){return null==t?void 0:t[e]}}({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});var Jt=function(t){return"symbol"==typeof t||tt(t)&&"[object Symbol]"==v(t)},Kt=o?o.prototype:void 0,Vt=Kt?Kt.toString:void 0;var Wt=function t(e){if("string"==typeof e)return e;if(it(e))return $t(e,t)+"";if(Jt(e))return Vt?Vt.call(e):"";var r=e+"";return"0"==r&&1/e==-1/0?"-0":r};var Qt=function(t){return null==t?"":Wt(t)},Xt=/[&<>"']/g,Yt=RegExp(Xt.source);var Zt={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:zt,variable:"",imports:{_:{escape:function(t){return(t=Qt(t))&&Yt.test(t)?t.replace(Xt,Gt):t}}}},te=/\b__p \+= '';/g,ee=/\b(__p \+=) '' \+/g,re=/(__e\(.*?\)|\b__t\)) \+\n'';/g,ne=/[()=,{}\[\]\/\s]/,oe=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,ue=/($^)/,ie=/['\n\r\u2028\u2029\\]/g,ce=Object.prototype.hasOwnProperty;var ae=function(t,e,r){var n=Zt.imports._.templateSettings||Zt;r&&X(t,e,r)&&(e=void 0),t=Qt(t),e=_t({},e,n,Lt);var o,u,i=_t({},e.imports,n.imports,Lt),c=Ht(i),a=Ft(i,c),l=0,f=e.interpolate||ue,p="__p += '",s=RegExp((e.escape||ue).source+"|"+f.source+"|"+(f===zt?oe:ue).source+"|"+(e.evaluate||ue).source+"|$","g"),y=ce.call(e,"sourceURL")?"//# sourceURL="+(e.sourceURL+"").replace(/\s/g," ")+"\n":"";t.replace(s,(function(e,r,n,i,c,a){return n||(n=i),p+=t.slice(l,a).replace(ie,It),r&&(o=!0,p+="' +\n__e("+r+") +\n'"),c&&(u=!0,p+="';\n"+c+";\n__p += '"),n&&(p+="' +\n((__t = ("+n+")) == null ? '' : __t) +\n'"),l=a+e.length,e})),p+="';\n";var v=ce.call(e,"variable")&&e.variable;if(v){if(ne.test(v))throw new Error("Invalid `variable` option passed into `_.template`")}else p="with (obj) {\n"+p+"\n}\n";p=(u?p.replace(te,""):p).replace(ee,"$1").replace(re,"$1;"),p="function("+(v||"obj")+") {\n"+(v?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(o?", __e = _.escape":"")+(u?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+p+"return __p\n}";var b=Rt((function(){return Function(c,y+"return "+p).apply(void 0,a)}));if(b.source=p,Tt(b))throw b;return b};function le(t){return(le="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function fe(t,e){if(e&&("object"===le(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function pe(t){var e="function"==typeof Map?new Map:void 0;return(pe=function(t){if(null===t||(r=t,-1===Function.toString.call(r).indexOf("[native code]")))return t;var r;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return se(t,arguments,be(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),ve(n,t)})(t)}function se(t,e,r){return(se=ye()?Reflect.construct:function(t,e,r){var n=[null];n.push.apply(n,e);var o=new(Function.bind.apply(t,n));return r&&ve(o,r.prototype),o}).apply(null,arguments)}function ye(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function ve(t,e){return(ve=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function be(t){return(be=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function de(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function he(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function je(t,e,r){return e&&he(t.prototype,e),r&&he(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}var ge,me,Oe,_e=function(){function t(e){de(this,t),this.app=e}return je(t,[{key:"createCallback",value:function(t,e,r){switch(t){case"list":return function(t){var n=document.querySelector(e);n.querySelector('[data-value="'.concat(t.value,'"]'))?alert(u.__("unicorn.field.modal.already.selected")):(n.append(t,!0),document.querySelector(r).close())};case"single":default:return function(t){var n=document.querySelector(e),o=n.querySelector("[data-role=image]"),i=n.querySelector("[data-role=title]"),c=n.querySelector("[data-role=value]");o&&t.image&&(o.style.backgroundImage="url(".concat(t.image,");")),i.value=t.title||"",c.value=t.value||"",c.dispatchEvent(new CustomEvent("change")),document.querySelector(r).close(),u.$ui.highlight(i)}}}}],[{key:"install",value:function(t){u.import("@sortablejs"),t.$modalField=new this(t)}}]),t}(),we=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ve(t,e)}(o,t);var e,r,n=(e=o,r=ye(),function(){var t,n=be(e);if(r){var o=be(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return fe(this,t)});function o(){return de(this,o),n.apply(this,arguments)}return je(o,[{key:"listContainer",get:function(){return this.querySelector("[data-role=list-container]")}},{key:"modal",get:function(){return document.querySelector(this.options.modalSelector)}},{key:"items",get:function(){return this.listContainer.children}},{key:"connectedCallback",value:function(){var t=this;this.options=JSON.parse(this.getAttribute("options")||"{}"),this.itemTemplate=ae(document.querySelector(this.options.itemTemplate).innerHTML),this.options.sortable&&u.import("@sortablejs").then((function(){new Sortable(t.listContainer,{handle:".h-drag-handle"})}));var e=this.querySelector("[data-role=select]");e.addEventListener("click",(function(e){t.open(e)})),this.querySelector("[data-role=clear]").addEventListener("click",(function(){[].forEach.call(t.items,(function(t){t.querySelector("[data-role=remove]").click()}))})),e.style.pointerEvents=null,this.render()}},{key:"render",value:function(){var t=this;(u.data("unicorn.modal-field")[this.options.dataKey]||[]).forEach((function(e){t.append(e)}))}},{key:"append",value:function(t){var e=this,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=u.html(this.itemTemplate({item:t}));n.dataset.value=t.value,n.querySelector("[data-role=remove]").addEventListener("click",(function(){u.$ui.slideUp(n).then((function(){n.remove(),e.toggleRequired()}))})),this.listContainer.appendChild(n),this.toggleRequired(),r&&u.$ui.highlight(n)}},{key:"toggleRequired",value:function(){var t=this.querySelector("[data-role=validation-placeholder]");t&&(t.disabled=0!==this.listContainer.children.length)}},{key:"open",value:function(t){t.preventDefault(),t.stopPropagation();var e=this.options.max;e&&this.listContainer.children.length>=e?alert(u.__("unicorn.field.modal.max.selected",e)):this.modal.open(t.target.href,{size:"modal-xl"})}}]),o}(pe(HTMLElement));Oe="uni-modal-list",(me="is")in(ge=we)?Object.defineProperty(ge,me,{value:Oe,enumerable:!0,configurable:!0,writable:!0}):ge[me]=Oe,u.defineCustomElement(we.is,we),u.use(_e)}])}));
//# sourceMappingURL=modal-field.js.map