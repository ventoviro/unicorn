!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var r=e();for(var n in r)("object"==typeof exports?exports:t)[n]=r[n]}}(self,(()=>(()=>{"use strict";var t={};(t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})})(t);const e="object"==typeof global&&global&&global.Object===Object&&global;var r="object"==typeof self&&self&&self.Object===Object&&self;const n=e||r||Function("return this")(),o=n.Symbol;var c=Object.prototype,i=c.hasOwnProperty,a=c.toString,l=o?o.toStringTag:void 0;var s=Object.prototype.toString;var p=o?o.toStringTag:void 0;const f=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":p&&p in Object(t)?function(t){var e=i.call(t,l),r=t[l];try{t[l]=void 0;var n=!0}catch(t){}var o=a.call(t);return n&&(e?t[l]=r:delete t[l]),o}(t):function(t){return s.call(t)}(t)},y=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)},v=function(t){if(!y(t))return!1;var e=f(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e},b=n["__core-js_shared__"];var d,g=(d=/[^.]+$/.exec(b&&b.keys&&b.keys.IE_PROTO||""))?"Symbol(src)_1."+d:"";var h=Function.prototype.toString;var j=/^\[object .+?Constructor\]$/,m=Function.prototype,_=Object.prototype,O=m.toString,S=_.hasOwnProperty,w=RegExp("^"+O.call(S).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");const x=function(t){return!(!y(t)||(e=t,g&&g in e))&&(v(t)?w:j).test(function(t){if(null!=t){try{return h.call(t)}catch(t){}try{return t+""}catch(t){}}return""}(t));var e},q=function(){try{var t=function(t,e){var r=function(t,e){return null==t?void 0:t[e]}(t,e);return x(r)?r:void 0}(Object,"defineProperty");return t({},"",{}),t}catch(t){}}(),A=function(t,e,r){"__proto__"==e&&q?q(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r},E=function(t,e){return t===e||t!=t&&e!=e};var P=Object.prototype.hasOwnProperty;const $=function(t,e,r){var n=t[e];P.call(t,e)&&E(n,r)&&(void 0!==r||e in t)||A(t,e,r)},T=function(t){return t},C=function(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)};var F=Math.max;const k=function(t){return function(){return t}},R=q?function(t,e){return q(t,"toString",{configurable:!0,enumerable:!1,value:k(e),writable:!0})}:T;var L=Date.now;const U=(M=R,I=0,D=0,function(){var t=L(),e=16-(t-D);if(D=t,e>0){if(++I>=800)return arguments[0]}else I=0;return M.apply(void 0,arguments)});var M,I,D;const B=function(t,e){return U(function(t,e,r){return e=F(void 0===e?t.length-1:e,0),function(){for(var n=arguments,o=-1,c=F(n.length-e,0),i=Array(c);++o<c;)i[o]=n[e+o];o=-1;for(var a=Array(e+1);++o<e;)a[o]=n[o];return a[e]=r(i),C(t,this,a)}}(t,e,T),t+"")},N=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991},H=function(t){return null!=t&&N(t.length)&&!v(t)};var z=/^(?:0|[1-9]\d*)$/;const G=function(t,e){var r=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==r||"symbol"!=r&&z.test(t))&&t>-1&&t%1==0&&t<e},J=function(t,e,r){if(!y(r))return!1;var n=typeof e;return!!("number"==n?H(r)&&G(e,r.length):"string"==n&&e in r)&&E(r[e],t)},K=function(t){return null!=t&&"object"==typeof t},V=function(t){return K(t)&&"[object Arguments]"==f(t)};var W=Object.prototype,Q=W.hasOwnProperty,X=W.propertyIsEnumerable,Y=V(function(){return arguments}())?V:function(t){return K(t)&&Q.call(t,"callee")&&!X.call(t,"callee")};const Z=Y,tt=Array.isArray;var et="object"==typeof exports&&exports&&!exports.nodeType&&exports,rt=et&&"object"==typeof module&&module&&!module.nodeType&&module,nt=rt&&rt.exports===et?n.Buffer:void 0;const ot=(nt?nt.isBuffer:void 0)||function(){return!1};var ct={};ct["[object Float32Array]"]=ct["[object Float64Array]"]=ct["[object Int8Array]"]=ct["[object Int16Array]"]=ct["[object Int32Array]"]=ct["[object Uint8Array]"]=ct["[object Uint8ClampedArray]"]=ct["[object Uint16Array]"]=ct["[object Uint32Array]"]=!0,ct["[object Arguments]"]=ct["[object Array]"]=ct["[object ArrayBuffer]"]=ct["[object Boolean]"]=ct["[object DataView]"]=ct["[object Date]"]=ct["[object Error]"]=ct["[object Function]"]=ct["[object Map]"]=ct["[object Number]"]=ct["[object Object]"]=ct["[object RegExp]"]=ct["[object Set]"]=ct["[object String]"]=ct["[object WeakMap]"]=!1;var it="object"==typeof exports&&exports&&!exports.nodeType&&exports,at=it&&"object"==typeof module&&module&&!module.nodeType&&module,ut=at&&at.exports===it&&e.process,lt=function(){try{return at&&at.require&&at.require("util").types||ut&&ut.binding&&ut.binding("util")}catch(t){}}(),st=lt&&lt.isTypedArray;const pt=st?function(t){return function(e){return t(e)}}(st):function(t){return K(t)&&N(t.length)&&!!ct[f(t)]};var ft=Object.prototype.hasOwnProperty;const yt=function(t,e){var r=tt(t),n=!r&&Z(t),o=!r&&!n&&ot(t),c=!r&&!n&&!o&&pt(t),i=r||n||o||c,a=i?function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}(t.length,String):[],u=a.length;for(var l in t)!e&&!ft.call(t,l)||i&&("length"==l||o&&("offset"==l||"parent"==l)||c&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||G(l,u))||a.push(l);return a};var vt=Object.prototype;const bt=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||vt)};var dt=Object.prototype.hasOwnProperty;const gt=function(t){if(!y(t))return function(t){var e=[];if(null!=t)for(var r in Object(t))e.push(r);return e}(t);var e=bt(t),r=[];for(var n in t)("constructor"!=n||!e&&dt.call(t,n))&&r.push(n);return r},ht=(jt=function(t,e,r,n){!function(t,e,r,n){var o=!r;r||(r={});for(var c=-1,i=e.length;++c<i;){var a=e[c],u=n?n(r[a],t[a],a,r,t):void 0;void 0===u&&(u=t[a]),o?A(r,a,u):$(r,a,u)}}(e,function(t){return H(t)?yt(t,!0):gt(t)}(e),t,n)},B((function(t,e){var r=-1,n=e.length,o=n>1?e[n-1]:void 0,c=n>2?e[2]:void 0;for(o=jt.length>3&&"function"==typeof o?(n--,o):void 0,c&&J(e[0],e[1],c)&&(o=n<3?void 0:o,n=1),t=Object(t);++r<n;){var i=e[r];i&&jt(t,i,r,o)}return t})));var jt;const mt=function(t,e){return function(r){return t(e(r))}},_t=mt(Object.getPrototypeOf,Object);var Ot=Function.prototype,St=Object.prototype,wt=Ot.toString,xt=St.hasOwnProperty,qt=wt.call(Object);const At=function(t){if(!K(t))return!1;var e=f(t);return"[object Error]"==e||"[object DOMException]"==e||"string"==typeof t.message&&"string"==typeof t.name&&!function(t){if(!K(t)||"[object Object]"!=f(t))return!1;var e=_t(t);if(null===e)return!0;var r=xt.call(e,"constructor")&&e.constructor;return"function"==typeof r&&r instanceof r&&wt.call(r)==qt}(t)},Et=B((function(t,e){try{return C(t,void 0,e)}catch(t){return At(t)?t:new Error(t)}})),Pt=function(t,e){for(var r=-1,n=null==t?0:t.length,o=Array(n);++r<n;)o[r]=e(t[r],r,t);return o};var $t=Object.prototype,Tt=$t.hasOwnProperty;const Ct=function(t,e,r,n){return void 0===t||E(t,$t[r])&&!Tt.call(n,r)?e:t};var Ft={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"};const kt=function(t){return"\\"+Ft[t]},Rt=mt(Object.keys,Object);var Lt=Object.prototype.hasOwnProperty;const Ut=function(t){return H(t)?yt(t):function(t){if(!bt(t))return Rt(t);var e=[];for(var r in Object(t))Lt.call(t,r)&&"constructor"!=r&&e.push(r);return e}(t)},Mt=/<%=([\s\S]+?)%>/g,It=(Dt={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},function(t){return null==Dt?void 0:Dt[t]});var Dt;var Bt=o?o.prototype:void 0,Nt=Bt?Bt.toString:void 0;const Ht=function t(e){if("string"==typeof e)return e;if(tt(e))return Pt(e,t)+"";if(function(t){return"symbol"==typeof t||K(t)&&"[object Symbol]"==f(t)}(e))return Nt?Nt.call(e):"";var r=e+"";return"0"==r&&1/e==-1/0?"-0":r},zt=function(t){return null==t?"":Ht(t)};var Gt=/[&<>"']/g,Jt=RegExp(Gt.source);const Kt={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:Mt,variable:"",imports:{_:{escape:function(t){return(t=zt(t))&&Jt.test(t)?t.replace(Gt,It):t}}}};var Vt=/\b__p \+= '';/g,Wt=/\b(__p \+=) '' \+/g,Qt=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Xt=/[()=,{}\[\]\/\s]/,Yt=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Zt=/($^)/,te=/['\n\r\u2028\u2029\\]/g,ee=Object.prototype.hasOwnProperty;const re=function(t,e,r){var n=Kt.imports._.templateSettings||Kt;r&&J(t,e,r)&&(e=void 0),t=zt(t),e=ht({},e,n,Ct);var o,c,i=ht({},e.imports,n.imports,Ct),a=Ut(i),u=function(t,e){return Pt(e,(function(e){return t[e]}))}(i,a),l=0,s=e.interpolate||Zt,p="__p += '",f=RegExp((e.escape||Zt).source+"|"+s.source+"|"+(s===Mt?Yt:Zt).source+"|"+(e.evaluate||Zt).source+"|$","g"),y=ee.call(e,"sourceURL")?"//# sourceURL="+(e.sourceURL+"").replace(/\s/g," ")+"\n":"";t.replace(f,(function(e,r,n,i,a,u){return n||(n=i),p+=t.slice(l,u).replace(te,kt),r&&(o=!0,p+="' +\n__e("+r+") +\n'"),a&&(c=!0,p+="';\n"+a+";\n__p += '"),n&&(p+="' +\n((__t = ("+n+")) == null ? '' : __t) +\n'"),l=u+e.length,e})),p+="';\n";var v=ee.call(e,"variable")&&e.variable;if(v){if(Xt.test(v))throw new Error("Invalid `variable` option passed into `_.template`")}else p="with (obj) {\n"+p+"\n}\n";p=(c?p.replace(Vt,""):p).replace(Wt,"$1").replace(Qt,"$1;"),p="function("+(v||"obj")+") {\n"+(v?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(o?", __e = _.escape":"")+(c?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+p+"return __p\n}";var b=Et((function(){return Function(a,y+"return "+p).apply(void 0,u)}));if(b.source=p,At(b))throw b;return b};class ne extends HTMLElement{get listContainer(){return this.querySelector("[data-role=list-container]")}get modal(){return document.querySelector(this.options.modalSelector)}get items(){return this.listContainer.children}connectedCallback(){this.options=JSON.parse(this.getAttribute("options")||"{}"),this.itemTemplate=re(document.querySelector(this.options.itemTemplate).innerHTML);const t=this.querySelector("[data-role=empty]");t&&(t.name=t.dataset.name),this.options.sortable&&u.import("@sortablejs").then((()=>{new Sortable(this.listContainer,{handle:".h-drag-handle"})}));const e=this.querySelector("[data-role=select]");e.addEventListener("click",(t=>{this.open(t)})),this.querySelector("[data-role=clear]").addEventListener("click",(()=>{[].forEach.call(this.items,(t=>{t.querySelector("[data-role=remove]").click()}))})),e.style.pointerEvents=null,this.render()}render(){(u.data("unicorn.modal-field")[this.options.dataKey]||[]).forEach((t=>{this.append(t)}))}append(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=u.html(this.itemTemplate({item:t}));r.dataset.value=t.value,r.querySelector("[data-role=remove]").addEventListener("click",(()=>{u.$ui.slideUp(r).then((()=>{r.remove(),this.toggleRequired()}))})),this.listContainer.appendChild(r),this.toggleRequired(),e&&u.$ui.highlight(r)}toggleRequired(){const t=this.querySelector("[data-role=validation-placeholder]");t&&(t.disabled=0!==this.listContainer.children.length)}open(t){t.preventDefault(),t.stopPropagation();const e=this.options.max;e&&this.listContainer.children.length>=e?alert(u.__("unicorn.field.modal.max.selected",e)):this.modal.open(t.target.href,{size:"modal-xl"})}}var oe,ce,ie,ae;return oe=ne,ie="uni-modal-list",(ce="symbol"==typeof(ae=function(t,e){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(ce="is"))?ae:String(ae))in oe?Object.defineProperty(oe,ce,{value:ie,enumerable:!0,configurable:!0,writable:!0}):oe[ce]=ie,u.defineCustomElement(ne.is,ne),u.use(class{static install(t){t.$modalField=new this(t)}constructor(t){this.app=t}createCallback(t,e,r){return"list"===t?t=>{const n=document.querySelector(e);n.querySelector(`[data-value="${t.value}"]`)?alert(u.__("unicorn.field.modal.already.selected")):(n.append(t,!0),document.querySelector(r).close())}:t=>{const n=document.querySelector(e),o=n.querySelector("[data-role=image]"),c=n.querySelector("[data-role=title]"),i=n.querySelector("[data-role=value]");o&&t.image&&(o.style.backgroundImage=`url(${t.image});`),c.value=t.title||"",i.value=t.value||"",i.dispatchEvent(new CustomEvent("change")),document.querySelector(r).close(),u.$ui.highlight(c)}}}),t})()));
//# sourceMappingURL=modal-field.js.map