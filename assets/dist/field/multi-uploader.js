/*! For license information please see multi-uploader.js.LICENSE.txt */
(()=>{var e={357:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>l});var r=n(221),o=n.n(r),i=n(758),a=n.n(i)()(o());a.push([e.id,".vue-drag-uploader{display:flex;flex-wrap:wrap;padding:15px 5px 5px 15px;border:1px dotted #999;border-radius:4px;cursor:pointer;color:#999;min-height:250px}.vue-drag-uploader--readonly{border:1px solid #999}.vue-drag-uploader--ondrag{border:1px dotted #666;background-color:rgba(0,0,0,0.05);color:#666}.vue-drag-uploader__draggable-wrapper,.vue-drag-uploader__transition-wrapper{display:flex;flex-wrap:wrap}.vue-drag-uploader__item{width:155px;height:155px;border:1px solid rgba(0,0,0,0.25);border-radius:3px;cursor:pointer;margin-right:15px;margin-bottom:15px}.vue-drag-uploader .add-button{display:flex;align-items:center;text-align:center;transition:background-color .5s}.vue-drag-uploader .add-button:hover{background-color:rgba(0,0,0,0.05)}.vue-drag-uploader .add-button__body{margin:0 auto}.vue-drag-uploader .add-button__icon{margin-bottom:10px}.vue-drag-uploader .add-button__text{font-size:14px}.vue-drag-uploader .preview-img{position:relative;cursor:pointer;padding:1px}.vue-drag-uploader .preview-img>*{position:absolute}.vue-drag-uploader .preview-img:hover .error-message__message{display:block;padding:10px}.vue-drag-uploader .preview-img__body{left:0;top:0;width:100%;height:100%;background:transparent no-repeat center center;background-size:cover}.vue-drag-uploader .preview-img__title{margin:0 auto}.vue-drag-uploader .preview-img__overlay{display:flex;align-items:center;left:0;top:0;bottom:0;right:0;background-color:rgba(0,0,0,0.35);opacity:0;transition:opacity .5s}.vue-drag-uploader .preview-img__overlay:hover{opacity:1}.vue-drag-uploader .preview-img__remove-icon{position:absolute;top:5px;right:5px;color:white;opacity:.75;transition:opacity .5s}.vue-drag-uploader .preview-img__remove-icon:hover{opacity:1}.vue-drag-uploader .preview-img__progress{height:5px;background-color:rgba(255,255,255,0.8);width:100%;bottom:0;left:0}.vue-drag-uploader .preview-img__progress-bar{background-color:var(--bs-primary, #007bff);width:0;height:100%}.vue-drag-uploader .error-message{width:100%;background-color:#dc3545;color:white;font-size:14px;word-break:break-all;top:calc(100% - 26px);min-height:26px}.vue-drag-uploader .error-message__notice{display:inline-block;padding:3px;text-align:center;width:100%}.vue-drag-uploader .error-message__message{display:none}\n","",{version:3,sources:["webpack://./scss/field/vue-drag-uploader.scss"],names:[],mappings:"AAKA,mBACE,YAAa,CACb,cAAe,CACf,yBAA0B,CAC1B,sBAAuB,CACvB,iBAAkB,CAClB,cAAe,CACf,UAAW,CACX,gBAAiB,CAEjB,6BACE,qBAAsB,CACvB,2BAGC,sBAAuB,CACvB,iCAAoC,CACpC,UAAW,CACZ,6EAIC,YAAa,CACb,cAAe,CAChB,yBAGC,WA9Ba,CA+Bb,YA9Bc,CA+Bd,iCAAoC,CACpC,iBAAkB,CAClB,cAAe,CACf,iBAAkB,CAClB,kBAAmB,CAjCvB,+BAqCI,YAAa,CACb,kBAAmB,CACnB,iBAAkB,CAClB,+BAAgC,CAxCpC,qCA2CM,iCAAoC,CA3C1C,qCA+CM,aAAc,CA/CpB,qCAmDM,kBAAmB,CAnDzB,qCAuDM,cAAe,CAvDrB,gCA4DI,iBAAkB,CAClB,cAAe,CACf,WAAY,CA9DhB,kCAiEM,iBAAkB,CAjExB,8DAuEU,aAAc,CACd,YAAa,CAxEvB,sCA8EM,MAAO,CACP,KAAM,CACN,UAAW,CACX,WAAY,CACZ,8CAA+C,CAC/C,qBAAsB,CAnF5B,uCAuFM,aAAc,CAvFpB,yCA2FM,YAAa,CACb,kBAAmB,CACnB,MAAO,CACP,KAAM,CACN,QAAS,CACT,OAAQ,CACR,iCAAoC,CACpC,SAAU,CACV,sBAAuB,CAnG7B,+CAsGQ,SAAU,CAtGlB,6CA2GM,iBAAkB,CAClB,OAAQ,CACR,SAAU,CACV,WAAY,CACZ,WAAY,CACZ,sBAAuB,CAhH7B,mDAmHQ,SAAU,CAnHlB,0CAwHM,UAAW,CACX,sCAAyC,CACzC,UAAW,CACX,QAAS,CACT,MAAO,CA5Hb,8CAgIM,2CAA4C,CAC5C,OAAQ,CACR,WAAY,CAlIlB,kCAuII,UAAW,CACX,wBAAyB,CACzB,WAAY,CACZ,cAAe,CACf,oBAAqB,CACrB,qBAAsB,CACtB,eAAgB,CA7IpB,0CAgJM,oBAAqB,CACrB,WAAY,CACZ,iBAAkB,CAClB,UAAW,CAnJjB,2CAuJM,YAAa",sourcesContent:["// Part of ke file.\n\n$img-width: 155px !default;\n$img-height: 155px !default;\n\n.vue-drag-uploader {\n  display: flex;\n  flex-wrap: wrap;\n  padding: 15px 5px 5px 15px;\n  border: 1px dotted #999;\n  border-radius: 4px;\n  cursor: pointer;\n  color: #999;\n  min-height: 250px;\n\n  &--readonly {\n    border: 1px solid #999;\n  }\n\n  &--ondrag {\n    border: 1px dotted #666;\n    background-color: rgba(0, 0, 0, .05);\n    color: #666;\n  }\n\n  &__draggable-wrapper,\n  &__transition-wrapper {\n    display: flex;\n    flex-wrap: wrap;\n  }\n\n  &__item {\n    width: $img-width;\n    height: $img-height;\n    border: 1px solid rgba(0, 0, 0, .25);\n    border-radius: 3px;\n    cursor: pointer;\n    margin-right: 15px;\n    margin-bottom: 15px;\n  }\n\n  .add-button {\n    display: flex;\n    align-items: center;\n    text-align: center;\n    transition: background-color .5s;\n\n    &:hover {\n      background-color: rgba(0, 0, 0, .05);\n    }\n\n    &__body {\n      margin: 0 auto;\n    }\n\n    &__icon {\n      margin-bottom: 10px;\n    }\n\n    &__text {\n      font-size: 14px;\n    }\n  }\n\n  .preview-img {\n    position: relative;\n    cursor: pointer;\n    padding: 1px;\n\n    > * {\n      position: absolute;\n    }\n\n    &:hover {\n      .error-message {\n        &__message {\n          display: block;\n          padding: 10px;\n        }\n      }\n    }\n\n    &__body {\n      left: 0;\n      top: 0;\n      width: 100%;\n      height: 100%;\n      background: transparent no-repeat center center;\n      background-size: cover;\n    }\n\n    &__title {\n      margin: 0 auto;\n    }\n\n    &__overlay {\n      display: flex;\n      align-items: center;\n      left: 0;\n      top: 0;\n      bottom: 0;\n      right: 0;\n      background-color: rgba(0, 0, 0, .35);\n      opacity: 0;\n      transition: opacity .5s;\n\n      &:hover {\n        opacity: 1;\n      }\n    }\n\n    &__remove-icon {\n      position: absolute;\n      top: 5px;\n      right: 5px;\n      color: white;\n      opacity: .75;\n      transition: opacity .5s;\n\n      &:hover {\n        opacity: 1;\n      }\n    }\n\n    &__progress {\n      height: 5px;\n      background-color: rgba(255, 255, 255, .8);\n      width: 100%;\n      bottom: 0;\n      left: 0;\n    }\n\n    &__progress-bar {\n      background-color: var(--bs-primary, #007bff);\n      width: 0;\n      height: 100%;\n    }\n  }\n\n  .error-message {\n    width: 100%;\n    background-color: #dc3545;\n    color: white;\n    font-size: 14px;\n    word-break: break-all;\n    top: calc(100% - 26px);\n    min-height: 26px;\n\n    &__notice {\n      display: inline-block;\n      padding: 3px;\n      text-align: center;\n      width: 100%;\n    }\n\n    &__message {\n      display: none;\n    }\n  }\n}\n"],sourceRoot:""}]);const l=a},758:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",r=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),r&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),r&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,r,o,i){"string"==typeof e&&(e=[[null,e,void 0]]);var a={};if(r)for(var l=0;l<this.length;l++){var u=this[l][0];null!=u&&(a[u]=!0)}for(var s=0;s<e.length;s++){var c=[].concat(e[s]);r&&a[c[0]]||(void 0!==i&&(void 0===c[5]||(c[1]="@layer".concat(c[5].length>0?" ".concat(c[5]):""," {").concat(c[1],"}")),c[5]=i),n&&(c[2]?(c[1]="@media ".concat(c[2]," {").concat(c[1],"}"),c[2]=n):c[2]=n),o&&(c[4]?(c[1]="@supports (".concat(c[4],") {").concat(c[1],"}"),c[4]=o):c[4]="".concat(o)),t.push(c))}},t}},221:e=>{"use strict";e.exports=function(e){var t=e[1],n=e[3];if(!n)return t;if("function"==typeof btoa){var r=btoa(unescape(encodeURIComponent(JSON.stringify(n)))),o="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(r),i="/*# ".concat(o," */"),a=n.sources.map((function(e){return"/*# sourceURL=".concat(n.sourceRoot||"").concat(e," */")}));return[t].concat(a).concat([i]).join("\n")}return[t].join("\n")}},789:(e,t)=>{"use strict";t.Z=(e,t)=>{const n=e.__vccOpts||e;for(const[e,r]of t)n[e]=r;return n}},395:(e,t,n)=>{var r=n(357);r.__esModule&&(r=r.default),"string"==typeof r&&(r=[[e.id,r,""]]),r.locals&&(e.exports=r.locals),(0,n(840).Z)("70408d98",r,!0,{})},840:(e,t,n)=>{"use strict";function r(e,t){for(var n=[],r={},o=0;o<t.length;o++){var i=t[o],a=i[0],l={id:e+":"+o,css:i[1],media:i[2],sourceMap:i[3]};r[a]?r[a].parts.push(l):n.push(r[a]={id:a,parts:[l]})}return n}n.d(t,{Z:()=>m});var o="undefined"!=typeof document;if("undefined"!=typeof DEBUG&&DEBUG&&!o)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var i={},a=o&&(document.head||document.getElementsByTagName("head")[0]),l=null,u=0,s=!1,c=function(){},p=null,d="data-vue-ssr-id",f="undefined"!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function m(e,t,n,o){s=n,p=o||{};var a=r(e,t);return g(a),function(t){for(var n=[],o=0;o<a.length;o++){var l=a[o];(u=i[l.id]).refs--,n.push(u)}for(t?g(a=r(e,t)):a=[],o=0;o<n.length;o++){var u;if(0===(u=n[o]).refs){for(var s=0;s<u.parts.length;s++)u.parts[s]();delete i[u.id]}}}}function g(e){for(var t=0;t<e.length;t++){var n=e[t],r=i[n.id];if(r){r.refs++;for(var o=0;o<r.parts.length;o++)r.parts[o](n.parts[o]);for(;o<n.parts.length;o++)r.parts.push(A(n.parts[o]));r.parts.length>n.parts.length&&(r.parts.length=n.parts.length)}else{var a=[];for(o=0;o<n.parts.length;o++)a.push(A(n.parts[o]));i[n.id]={id:n.id,refs:1,parts:a}}}}function v(){var e=document.createElement("style");return e.type="text/css",a.appendChild(e),e}function A(e){var t,n,r=document.querySelector("style["+d+'~="'+e.id+'"]');if(r){if(s)return c;r.parentNode.removeChild(r)}if(f){var o=u++;r=l||(l=v()),t=y.bind(null,r,o,!1),n=y.bind(null,r,o,!0)}else r=v(),t=C.bind(null,r),n=function(){r.parentNode.removeChild(r)};return t(e),function(r){if(r){if(r.css===e.css&&r.media===e.media&&r.sourceMap===e.sourceMap)return;t(e=r)}else n()}}var h,b=(h=[],function(e,t){return h[e]=t,h.filter(Boolean).join("\n")});function y(e,t,n,r){var o=n?"":r.css;if(e.styleSheet)e.styleSheet.cssText=b(t,o);else{var i=document.createTextNode(o),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(i,a[t]):e.appendChild(i)}}function C(e,t){var n=t.css,r=t.media,o=t.sourceMap;if(r&&e.setAttribute("media",r),p.ssrId&&e.setAttribute(d,t.id),o&&(n+="\n/*# sourceURL="+o.sources[0]+" */",n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(o))))+" */"),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={id:r,exports:{}};return e[r](i,i.exports,n),i.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{"use strict";const e=Vue;var t={class:"vue-drag-uploader__wrapper"},r={class:"add-button__body"},o=(0,e.createElementVNode)("div",{class:"add-button__icon"},[(0,e.createElementVNode)("span",{class:"fa fa-upload fa-2x"})],-1),i={class:"add-button__text"};n(395);var a={key:1,class:"preview-img__body d-flex justify-content-center align-items-center"},l={class:"text-center"},s={style:{"word-break":"break-word"}},c={class:"preview-img__overlay"},p={key:2,class:"preview-img__progress"},d=(0,e.createElementVNode)("span",{class:"error-message__notice"},"Upload fail",-1),f={class:"error-message__message"};function m(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function v(e,t,n){return t&&g(e.prototype,t),n&&g(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function A(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var h=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};m(this,e),A(this,"queues",{}),this.app=t,this.$options=n}return v(e,[{key:"create",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;if(null==name)throw new Error("Please provide a name.");return new y(e)}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(null==e)throw new Error("Please provide a name.");return this.queues[e]||(this.queues[e]=this.create(t)),this.queues[e]}},{key:"set",value:function(e,t){if(null==e)throw new Error("Please provide a name.");return this.queues[e]=t,this}},{key:"remove",value:function(e){return delete this.queues[e],this}},{key:"all",value:function(){return this.queues}}],[{key:"install",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.$queue=new this(e,t);e.queue=n.get.bind(n)}}]),e}();A(h,"is","queue");var b,y=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;m(this,e),A(this,"items",[]),A(this,"maxRunning",1),A(this,"currentRunning",0),A(this,"running",!1),A(this,"observers",[]),this.maxRunning=t}return v(e,[{key:"push",value:function(e){var t=this,n=new Promise((function(n,r){t.items.push((function(){return Promise.resolve(e()).then(n)}))}));return this.run(),n}},{key:"run",value:function(){this.running||(this.running=!0),this.pop()}},{key:"pop",value:function(){var e=this,t=this.items.shift();return t?this.currentRunning>=this.maxRunning?(this.items.unshift(t),Promise.resolve()):(this.currentRunning++,this.notice(),t().then((function(t){return e.endPop(),t})).catch((function(t){return e.endPop(),Promise.reject(t)}))):(this.running=!1,Promise.resolve())}},{key:"endPop",value:function(){this.currentRunning--,this.notice(),this.pop()}},{key:"clear",value:function(){return this.items=[],this.notice(),this}},{key:"isEmpty",value:function(){return 0===this.items.length}},{key:"length",get:function(){return this.items.length}},{key:"peek",value:function(){return this.items}},{key:"observe",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.observers.push({handler:e,once:n.once||!1}),function(){t.off(e)}}},{key:"once",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.once=!0,this.observe(e,t)}},{key:"onEnd",value:function(e){return this.observe((function(t,n,r){0===n&&0===r&&e(t,n,r)}))}},{key:"notice",value:function(){var e=this;return this.observers.forEach((function(t){t.handler(e,e.length,e.currentRunning)})),this.observers=this.observers.filter((function(e){return!0!==e.once})),this}},{key:"off",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;return void 0===e?(this.observers=[],this):(this.observers=this.observers.filter((function(t){return t.handler!==e})),this)}}]),e}();b=window.swal=window.swal||function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;alert(e+" / "+t)};var C="completed",w={};function x(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function k(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?x(Object(n),!0).forEach((function(t){_(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}e.ref;var B=e.reactive,O=e.computed,S=(e.watch,e.toRefs),E=e.onMounted;const j={name:"vue-drag-uploader-item",props:{item:Object,i:Number,initState:String,uploadUrl:String,size:Number,isReadonly:Boolean,queueName:{type:String,default:"uploading"},maxConcurrent:[String,Number]},setup:function(e,t){var n=t.emit,r=B({state:C,progress:0,messages:{error:""}});function o(){r.state="uploading";var t=(new Date).valueOf(),o=new FormData;return o.append("file",e.item.file),e.item.title=e.item.title||e.item.file.name,n("upload-start",t),u.$http.post(e.uploadUrl,o,{onUploadProgress:function(e){e.lengthComputable&&(r.progress=e.loaded/e.total,n("upload-progress",t,r.progress))}}).then((function(t){r.state=C,e.item.url=t.data.data.url,e.item.download_url=t.data.data.download_url,a.value&&(e.item.thumb_url=t.data.data.thumb_url||t.data.data.url)})).catch((function(e){console.error(e),r.state="fail",r.messages.error=e.message||xhr.responseJSON.message})).finally((function(){e.item.file=null,n("upload-end",t)}))}r.state=e.initState,e.initState,E((function(){if("new"===e.initState){var t=new FileReader;t.onload=function(t){e.item.thumb_url=t.target.result},t.readAsDataURL(e.item.file);var n=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return w[e]=w[e]||new y(t),w[e]}(e.queueName,Number(e.maxConcurrent)||2);n.push((function(){return o()}))}}));var i=O((function(){return e.item.file?e.item.file.name:e.item.title?e.item.title:e.item.url.split("/").pop()})),a=O((function(){return t=(e.item.file?e.item.file.name:e.item.url).split(".").pop().split("?").shift(),-1!==["png","jpeg","jpg","gif","bmp","webp"].indexOf(t.toLowerCase());var t})),l=O((function(){return{pdf:"fas fa-file-pdf text-danger",xls:"fas fa-file-excel text-success",xlsx:"fas fa-file-excel text-success",doc:"fas fa-file-word text-primary",docx:"fas fa-file-word text-primary",ppt:"fas fa-file-powerpoint text-warning",pptx:"fas fa-file-powerpoint text-warning",zip:"fas fa-file-archive text-dark","7z":"fas fa-file-archive text-dark",rar:"fas fa-file-archive text-dark",mp4:"fas fa-file-video text-dark",avi:"fas fa-file-video text-dark",flv:"fas fa-file-video text-dark",mov:"fas fa-file-video text-dark",ogg:"fas fa-file-video text-dark",webm:"fas fa-file-video text-dark",mpg:"fas fa-file-video text-dark",mp3:"fas fa-file-audio text-dark",acc:"fas fa-file-audio text-dark",wav:"fas fa-file-audio text-dark"}[(e.item.file?e.item.file.name.split(".").pop():e.item.url.split(".").pop()).toLowerCase()]||"fas fa-file"}));return k(k({},S(r)),{},{upload:o,deleteSelf:function(){e.isReadonly||n("delete",e.item)},onClick:function(t){n("item-click",e.item,e.i,t)},isImage:a,icon:l,fileName:i})}};var P=n(789);const N=(0,P.Z)(j,[["render",function(t,n,r,o,i,u){return(0,e.openBlock)(),(0,e.createElementBlock)("div",{class:"vue-drag-uploader__item preview-img",style:(0,e.normalizeStyle)({width:r.size?r.size+"px":null,height:r.size?r.size+"px":null}),onClick:n[2]||(n[2]=function(){return o.onClick&&o.onClick.apply(o,arguments)})},[(0,e.renderSlot)(t.$slots,"it",{item:r.item},(function(){return[o.isImage?((0,e.openBlock)(),(0,e.createElementBlock)("div",{key:0,class:"preview-img__body",style:(0,e.normalizeStyle)({"background-image":"url("+(r.item.thumb_url||r.item.url)+")"})},null,4)):(0,e.createCommentVNode)("",!0),(0,e.createTextVNode)(),o.isImage?(0,e.createCommentVNode)("",!0):((0,e.openBlock)(),(0,e.createElementBlock)("div",a,[(0,e.createElementVNode)("div",l,[(0,e.createElementVNode)("div",null,[(0,e.createElementVNode)("span",{class:(0,e.normalizeClass)([o.icon,"fa-3x"])},null,2)]),(0,e.createTextVNode)(),(0,e.createElementVNode)("div",s,(0,e.toDisplayString)(o.fileName),1)])])),(0,e.createTextVNode)(),(0,e.createElementVNode)("div",c,[r.isReadonly?(0,e.createCommentVNode)("",!0):((0,e.openBlock)(),(0,e.createElementBlock)("span",{key:0,class:"preview-img__remove-icon fa fa-times",onClick:n[0]||(n[0]=(0,e.withModifiers)((function(e){return o.deleteSelf()}),["stop","prevent"]))})),(0,e.createTextVNode)(),(0,e.renderSlot)(t.$slots,"extra",{item:r.item})]),(0,e.createTextVNode)(),"uploading"===t.state?((0,e.openBlock)(),(0,e.createElementBlock)("div",p,[(0,e.createElementVNode)("div",{class:"preview-img__progress-bar",style:(0,e.normalizeStyle)({width:100*t.progress+"%"})},null,4)])):(0,e.createCommentVNode)("",!0),(0,e.createTextVNode)(),"fail"===t.state?((0,e.openBlock)(),(0,e.createElementBlock)("div",{key:3,class:"preview-img__error-message error-message",onClick:n[1]||(n[1]=(0,e.withModifiers)((function(){}),["stop","prevent"]))},[d,(0,e.createTextVNode)(),(0,e.createElementVNode)("span",f,(0,e.toDisplayString)(t.messages.error),1)])):(0,e.createCommentVNode)("",!0)]}))],4)}]]);function R(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function V(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?R(Object(n),!0).forEach((function(t){M(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):R(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function M(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function U(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var D=e.ref,T=e.reactive,z=e.toRefs,I=e.onMounted,q=e.computed,F=e.watch;const L={name:"vue-drag-uploader",components:{VueDragUploaderItem:N},props:{id:String,url:String,modelValue:{type:Array,default:function(){return[]}},maxFiles:[String,Number],maxConcurrent:[String,Number],thumbSize:Number,placeholder:String,accept:{type:String,default:""},disabled:{default:!1},readonly:{default:!1}},setup:function(e,t){var n,r,o=t.emit,i=D(null),a=T({items:[],uploadQueue:{}}),l=q((function(){return e.modelValue}));function s(){var e=new Date;return e.getTime()+"."+e.getMilliseconds()+"."+Math.random()}function c(e){Array.prototype.forEach.call(e,p),Array.prototype.forEach.call(e,(function(e){if(p(e),f.value){var t={id:"",key:s(),url:"",thumb_url:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=",uploadState:"new",file:e,title:"",alt:"",description:""};a.items.push(t)}}))}function p(e){var t=g.value,n=e.name.split(".").pop();if(t.length){var r=!1;if(t.forEach((function(t){r||(-1!==t.indexOf("/")?d(t,e.type)&&(r=!0):t.toLowerCase()===n.toLowerCase()&&(r=!0))})),!r)throw b(u.__("unicorn.field.file.drag.message.unaccepted.files"),u.__("unicorn.field.file.drag.message.unaccepted.files.desc",t.join(", ")),"warning"),new Error("Not accepted file ext")}}function d(e,t){var n=e.split("/"),r=t.split("/");return"*"===n[1]?n[0]===r[0]:e===t}I((function(){!function(e,t){e.value.addEventListener("dragover",(function(e){e.stopPropagation(),e.preventDefault(),e.currentTarget.classList.add("vue-drag-uploader--ondrag")})),e.value.addEventListener("dragleave",(function(e){e.stopPropagation(),e.preventDefault(),e.currentTarget.classList.remove("vue-drag-uploader--ondrag")})),e.value.addEventListener("drop",(function(e){e.stopPropagation(),e.preventDefault(),e.currentTarget.classList.remove("vue-drag-uploader--ondrag");var n=e.dataTransfer.items,r=[],o=function e(t){var n=[];if(i.length,t.isDirectory){var o=t.createReader();n.push(new Promise((function(t){var n=[];o.readEntries((function(r){r.forEach((function(t){n.push(e(t))})),Promise.all(n).then(t)}))})))}else n.push(new Promise((function(e){t.file((function(t){r.push(t),e(t)}))})));return Promise.all(n)},i=[],a=[];Array.prototype.forEach.call(n,(function(e){e.webkitGetAsEntry()&&a.push(o(e.webkitGetAsEntry()))})),a.length&&Promise.all(a).then((function(e){t(r)}))}))}(i,c)})),e.modelValue.map((function(e){e.key=e.key||s(),e.uploadState=C})),(n=a.items).push.apply(n,function(e){if(Array.isArray(e))return U(e)}(r=e.modelValue)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(r)||function(e,t){if(e){if("string"==typeof e)return U(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?U(e,t):void 0}}(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),null!=e.maxFiles&&e.maxFiles<a.items.length&&a.items.splice(e.maxFiles);var f=q((function(){return(null==e.maxFiles||a.items.length<e.maxFiles)&&!v.value})),m=q((function(){return Object.keys(a.uploadQueue),Object.keys(a.uploadQueue).length>0})),g=q((function(){return(Array.isArray(e.accept)?e.accept:e.accept.split(",")).map((function(e){return e.trim()})).filter((function(e){return e.length>0})).map((function(e){return-1===e.indexOf("/")&&"."===e[0]?e.substr(1):e}))})),v=q((function(){return e.disabled||e.readonly}));return F(l,(function(e){e.map((function(e){e.key=e.key||s()})),JSON.stringify(e)!==JSON.stringify(a.items)&&(a.items=e)}),{deep:!0}),F((function(){return a.items}),(function(e){o("update:modelValue",e)}),{deep:!0}),F(m,(function(e){o(e?"uploading":"uploaded")})),V(V({el:i},z(a)),{},{clickAdd:function(){var t=document.createElement("INPUT");t.setAttribute("id","luna-multi-uploader-selector"),t.setAttribute("type","file"),t.setAttribute("accept",e.accept),t.setAttribute("multiple",!0),t.style.display="none",t.addEventListener("change",(function(e){c(e.target.files),t.remove()})),t.addEventListener("change",(function(e){t.remove()})),document.body.appendChild(t),t.dispatchEvent(new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0}))},getKey:s,uploadFiles:c,checkFile:p,compareMimeType:d,deleteItem:function(e){o("delete-item",e),a.items=a.items.filter((function(t){return t.key!==e.key}))},uploadStart:function(e){a.uploadQueue[e]=0},uploadEnd:function(e){delete a.uploadQueue[e]},uploadProgress:function(e,t){a.uploadQueue[e]=t},itemClick:function(e,t,n){o("item-click",e,t,n)},canUpload:f,uploading:m,acceptedTypes:g,isReadonly:v})}},Y=(0,P.Z)(L,[["render",function(n,a,l,u,s,c){var p=(0,e.resolveComponent)("vue-drag-uploader-item"),d=(0,e.resolveComponent)("draggable");return(0,e.openBlock)(),(0,e.createElementBlock)("div",{ref:"el",class:(0,e.normalizeClass)(["vue-drag-uploader",{"vue-drag-uploader--readonly":u.isReadonly}])},[(0,e.createElementVNode)("div",t,[(0,e.createVNode)(d,(0,e.mergeProps)({modelValue:n.items,"onUpdate:modelValue":a[1]||(a[1]=function(e){return n.items=e}),class:"vue-drag-uploader__draggable-wrapper"},{draggable:".preview-img",animation:300},{disabled:u.isReadonly,onSort:a[2]||(a[2]=function(e){return n.$emit("reorder",e)}),"item-key":"key"}),{item:(0,e.withCtx)((function(t){var r=t.element,o=t.index;return[((0,e.openBlock)(),(0,e.createBlock)(p,{item:r,i:o,"init-state":r.uploadState,key:r.key,ref:r.key,"upload-url":l.url,size:l.thumbSize,"is-readonly":u.isReadonly,"queue-name":l.id,"max-concurrent":l.maxConcurrent,onDelete:u.deleteItem,onUploadStart:u.uploadStart,onUploadEnd:u.uploadEnd,onUploadProgress:u.uploadProgress,onItemClick:u.itemClick,style:{"animation-duration":".3s"}},{extra:(0,e.withCtx)((function(){return[(0,e.renderSlot)(n.$slots,"extra",{item:r,i:o,url:l.url,maxFiles:l.maxFiles,thumbSize:l.thumbSize,filesLimited:l.maxFiles})]})),_:2},1032,["item","i","init-state","upload-url","size","is-readonly","queue-name","max-concurrent","onDelete","onUploadStart","onUploadEnd","onUploadProgress","onItemClick"]))]})),footer:(0,e.withCtx)((function(){return[u.canUpload?((0,e.openBlock)(),(0,e.createElementBlock)("div",{class:"vue-drag-uploader__item add-button",key:"empty",onClick:a[0]||(a[0]=function(e){return u.clickAdd()}),style:(0,e.normalizeStyle)({width:l.thumbSize?l.thumbSize+"px":null,height:l.thumbSize?l.thumbSize+"px":null})},[(0,e.createElementVNode)("div",r,[o,(0,e.createTextVNode)(),(0,e.createElementVNode)("div",i,(0,e.toDisplayString)(l.placeholder),1)])],4)):(0,e.createCommentVNode)("",!0)]})),_:3},16,["modelValue","disabled"])])],2)}]]),W=Y;function Q(e){return Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Q(e)}function $(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function G(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$(Object(n),!0).forEach((function(t){re(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Z(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function H(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function J(e,t){if(t&&("object"===Q(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function K(e){var t="function"==typeof Map?new Map:void 0;return K=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return X(e,arguments,ne(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),te(r,e)},K(e)}function X(e,t,n){return X=ee()?Reflect.construct.bind():function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&te(o,n.prototype),o},X.apply(null,arguments)}function ee(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function te(e,t){return te=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},te(e,t)}function ne(e){return ne=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ne(e)}function re(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var oe=function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&te(e,t)}(l,t);var n,r,o,i,a=(n=l,r=ee(),function(){var e,t=ne(n);if(r){var o=ne(this).constructor;e=Reflect.construct(t,arguments,o)}else e=t.apply(this,arguments);return J(this,e)});function l(){return Z(this,l),a.apply(this,arguments)}return o=l,i=[{key:"connectedCallback",value:function(){var t=this,n=JSON.parse(this.getAttribute("options")||"{}");this.modalElement=this.querySelector(".modal");var r=n.tmplSelector||"#multi-uploader-field-tmpl";u.importSync("@sortablejs","@vuedraggable").then((function(){var o,i=(0,e.createApp)({name:"multi-uploader-field"});i.component("app",(o=n,{name:"multi-uploader-field-app",template:document.querySelector(r).innerHTML,props:{stackName:String},setup:function(t,n){var r=(0,e.reactive)(G(G({},o),{},{current:null,currentIndex:null,loading:!1})),i=(0,e.ref)(null),a=(0,e.ref)(null),l=(0,e.ref)(null);return G(G({app:l,modal:a,state:r,dragarea:i},(0,e.toRefs)(r)),{},{test:function(){r.current={foo:123}},openFile:function(e){r.openFileHandler?r.openFileHandler(e):window.open(e.download_url||e.url)},itemClick:function(t,n,o){r.current=t,r.currentIndex=n,(0,e.nextTick)().then((function(){new bootstrap.Modal(a.value).show()}))},metaSave:function(){r.current=null,r.currentIndex=null},isImage:function(e){var t=e.split(".").pop().split("?").shift();return-1!==["png","jpeg","jpg","gif","bmp","webp"].indexOf(t.toLowerCase())},dragover:function(e){r.canReplace&&(i.value.style.opacity=.75)},dragleave:function(e){r.canReplace&&(i.value.style.opacity=1)},drop:function(e){if(r.canReplace){i.value.style.opacity=1;var t=r.current,n=e.dataTransfer.files[0];if(l.value.checkFile(n),!l.value.isReadonly){new FileReader,t.file=n;var o=l.value.$refs[t.key];r.loading=!0,o.upload().finally((function(){r.loading=!1}))}}},uploading:function(){u.stack(t.stackName).push(!0)},uploaded:function(){u.stack(t.stackName).pop()}})}})),i.component("draggable",vuedraggable),i.component("vue-drag-uploader",W),i.mount(t),t.vm=i}))}}],i&&H(o.prototype,i),Object.defineProperty(o,"prototype",{writable:!1}),l}(K(HTMLElement));re(oe,"is","multi-uploader"),u.defineCustomElement(oe.is,oe)})()})();
//# sourceMappingURL=multi-uploader.js.map